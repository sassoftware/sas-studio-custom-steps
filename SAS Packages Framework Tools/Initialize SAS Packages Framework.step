<<<<<<< HEAD
{"creationTimeStamp":"2025-12-05T20:30:48.870099Z","createdBy":"Stu.Sztukowski@sas.com","modifiedTimeStamp":"2026-02-02T22:07:58.712782Z","modifiedBy":"Stu.Sztukowski@sas.com","id":"f5c86c1d-4813-4046-8bdc-b6bd4c024fca","name":"Initialize SAS Packages Framework.step","displayName":"Initialize SAS Packages Framework.step","localDisplayName":"Initialize SAS Packages Framework.step","links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca"},{"method":"POST","rel":"copy","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca/copy","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca/copy","responseType":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":1,"version":2,"type":"code","flowMetadata":{"inputPorts":[{"name":"inputtable1","displayName":"inputtable1","localDisplayName":"inputtable1","minEntries":0,"maxEntries":1,"defaultEntries":0,"type":"table"}],"outputPorts":[{"name":"outputtable1","displayName":"outputtable1","localDisplayName":"outputtable1","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table"}]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"init\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Initialize\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Initialize the SAS Package Framework and optionally install, update, and load SAS packages in bulk.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_debug\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Debug (Change dependency to view or hide)\",\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t1,\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t0\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_skip_init\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Skip re-initialization when already initialized\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_type\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Select a location for SPFInit.sas\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"URL\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"File\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_url\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"placeholder\": \"Enter a URL for spfinit.sas\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$spf_init_type\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"URL\"\n\t\t\t\t\t],\n\t\t\t\t\t\"regexp\": \"^(?:(http|ftp)(s)?:\\\\/\\\\/)?[\\\\w.-]+(?:\\\\.[\\\\w\\\\.-]+)+[\\\\w\\\\-\\\\._~:\\\\/?#[\\\\]@!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=.]+\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_fqp\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"pathtype\": \"file\",\n\t\t\t\t\t\"placeholder\": \"Select SPFInit.sas\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$spf_init_type\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"File\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_folder\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"Select a folder for SAS packages\",\n\t\t\t\t\t\"pathtype\": \"folder\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"outputtable1\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Used only to add an output port for connecting nodes\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"inputtable1\",\n\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\"label\": \"Used only to add an input port for connecting nodes\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"filter\": false,\n\t\t\t\t\t\"readonly\": false\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"Install_load\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Install / Load\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_install\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Install packages\",\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"indent\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_update\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Update Packages\",\n\t\t\t\t\t\"visible\": \"$spf_package_install\",\n\t\t\t\t\t\"indent\": 1\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_load\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Load packages\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text2\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"ℹ️ Packages stored in SAS Content will be copied to the WORK directory before loading.\",\n\t\t\t\t\t\"visible\": \"$spf_package_load\",\n\t\t\t\t\t\"indent\": 1\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_repo\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Package Repository\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"SAS Packages\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"PharmaForest\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"GitHub\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"Custom\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"$spf_package_install\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_github_name\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"placeholder\": \"Enter GitHub username or organization\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_repo\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"GitHub\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t\"$spf_package_install\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_custom_url\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"placeholder\": \"Enter URL for a package repository\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_repo\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"Custom\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t\"$spf_package_install\"\n\t\t\t\t\t],\n\t\t\t\t\t\"regexp\": \"^(?:(http|ftp)(s)?:\\\\/\\\\/)?[\\\\w.-]+(?:\\\\.[\\\\w\\\\.-]+)+[\\\\w\\\\-\\\\._~:\\\\/?#[\\\\]@!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=.]+\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_list_type\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Packages\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"List\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"File\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t],\n\t\t\t\t\t\"enabled\": [\n\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_list\",\n\t\t\t\t\t\"type\": \"textarea\",\n\t\t\t\t\t\"label\": \"Enter package list (space or carriage-return separated)\",\n\t\t\t\t\t\"placeholder\": \"Enter one or more packages\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_list_type\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"List\"\n\t\t\t\t\t\t]\n\t\t\t\t\t],\n\t\t\t\t\t\"enabled\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_list_type\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"List\"\n\t\t\t\t\t\t]\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_file_fqp\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"Select package file\",\n\t\t\t\t\t\"pathtype\": \"file\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_list_type\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"File\"\n\t\t\t\t\t\t]\n\t\t\t\t\t],\n\t\t\t\t\t\"enabled\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_list_type\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"File\"\n\t\t\t\t\t\t]\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"spf_init_debug\": false,\n\t\t\"spf_skip_init\": false,\n\t\t\"spf_init_type\": {\n\t\t\t\"value\": \"URL\"\n\t\t},\n\t\t\"spf_init_url\": \"https://raw.githubusercontent.com/yabwon/SAS_PACKAGES/refs/heads/main/SPF/SPFinit.sas\",\n\t\t\"spf_init_fqp\": \"\",\n\t\t\"spf_package_folder\": \"\",\n\t\t\"outputtable1\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"inputtable1\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"spf_package_install\": false,\n\t\t\"spf_package_update\": true,\n\t\t\"spf_package_load\": false,\n\t\t\"spf_repo\": {\n\t\t\t\"value\": \"SAS Packages\"\n\t\t},\n\t\t\"spf_github_name\": \"\",\n\t\t\"spf_custom_url\": \"\",\n\t\t\"spf_package_list_type\": {\n\t\t\t\"value\": \"List\"\n\t\t},\n\t\t\"spf_package_list\": \"\",\n\t\t\"spf_package_file_fqp\": \"\"\n\t},\n\t\"promptHierarchies\": []\n}","localUi":"{\"pages\":[{\"children\":[{\"id\":\"text1\",\"text\":\"Initialize the SAS Package Framework and optionally install, update, and load SAS packages in bulk.\",\"type\":\"text\",\"visible\":\"\"},{\"id\":\"spf_init_debug\",\"label\":\"Debug (Change dependency to view or hide)\",\"type\":\"checkbox\",\"visible\":[1,\"=\",0]},{\"id\":\"spf_skip_init\",\"label\":\"Skip re-initialization when already initialized\",\"type\":\"checkbox\",\"visible\":\"\"},{\"id\":\"spf_init_type\",\"items\":[{\"value\":\"URL\"},{\"value\":\"File\"}],\"label\":\"Select a location for SPFInit.sas\",\"type\":\"radiogroup\",\"visible\":\"\"},{\"id\":\"spf_init_url\",\"label\":\"\",\"placeholder\":\"Enter a URL for spfinit.sas\",\"regexp\":\"^(?:(http|ftp)(s)?:\\\\/\\\\/)?[\\\\w.-]+(?:\\\\.[\\\\w\\\\.-]+)+[\\\\w\\\\-\\\\._~:\\\\/?#[\\\\]@!\\\\$\\u0026'\\\\(\\\\)\\\\*\\\\+,;=.]+\",\"required\":true,\"type\":\"textfield\",\"visible\":[\"$spf_init_type\",\"=\",\"URL\"]},{\"id\":\"spf_init_fqp\",\"label\":\"\",\"pathtype\":\"file\",\"placeholder\":\"Select SPFInit.sas\",\"required\":true,\"type\":\"path\",\"visible\":[\"$spf_init_type\",\"=\",\"File\"]},{\"id\":\"spf_package_folder\",\"label\":\"Select a folder for SAS packages\",\"pathtype\":\"folder\",\"placeholder\":\"\",\"required\":true,\"type\":\"path\",\"visible\":\"\"},{\"id\":\"outputtable1\",\"label\":\"Used only to add an output port for connecting nodes\",\"placeholder\":\"\",\"required\":true,\"type\":\"outputtable\",\"visible\":\"\"},{\"filter\":false,\"id\":\"inputtable1\",\"label\":\"Used only to add an input port for connecting nodes\",\"placeholder\":\"\",\"readonly\":false,\"required\":false,\"type\":\"inputtable\",\"visible\":\"\"}],\"id\":\"init\",\"label\":\"Initialize\",\"type\":\"page\"},{\"children\":[{\"id\":\"spf_package_install\",\"indent\":0,\"label\":\"Install packages\",\"type\":\"checkbox\",\"visible\":\"\"},{\"id\":\"spf_package_update\",\"indent\":1,\"label\":\"Update Packages\",\"type\":\"checkbox\",\"visible\":\"$spf_package_install\"},{\"id\":\"spf_package_load\",\"label\":\"Load packages\",\"type\":\"checkbox\",\"visible\":\"\"},{\"id\":\"text2\",\"indent\":1,\"text\":\"ℹ️ Packages stored in SAS Content will be copied to the WORK directory before loading.\",\"type\":\"text\",\"visible\":\"$spf_package_load\"},{\"id\":\"spf_repo\",\"items\":[{\"value\":\"SAS Packages\"},{\"value\":\"PharmaForest\"},{\"value\":\"GitHub\"},{\"value\":\"Custom\"}],\"label\":\"Package Repository\",\"type\":\"radiogroup\",\"visible\":\"$spf_package_install\"},{\"id\":\"spf_github_name\",\"label\":\"\",\"placeholder\":\"Enter GitHub username or organization\",\"required\":true,\"type\":\"textfield\",\"visible\":[[\"$spf_repo\",\"=\",\"GitHub\"],\"\\u0026\",\"$spf_package_install\"]},{\"id\":\"spf_custom_url\",\"label\":\"\",\"placeholder\":\"Enter URL for a package repository\",\"regexp\":\"^(?:(http|ftp)(s)?:\\\\/\\\\/)?[\\\\w.-]+(?:\\\\.[\\\\w\\\\.-]+)+[\\\\w\\\\-\\\\._~:\\\\/?#[\\\\]@!\\\\$\\u0026'\\\\(\\\\)\\\\*\\\\+,;=.]+\",\"required\":true,\"type\":\"textfield\",\"visible\":[[\"$spf_repo\",\"=\",\"Custom\"],\"\\u0026\",\"$spf_package_install\"]},{\"enabled\":[\"$spf_package_install\",\"|\",\"$spf_package_load\"],\"id\":\"spf_package_list_type\",\"items\":[{\"value\":\"List\"},{\"value\":\"File\"}],\"label\":\"Packages\",\"type\":\"radiogroup\",\"visible\":[\"$spf_package_install\",\"|\",\"$spf_package_load\"]},{\"enabled\":[[\"$spf_package_install\",\"|\",\"$spf_package_load\"],\"\\u0026\",[\"$spf_package_list_type\",\"=\",\"List\"]],\"id\":\"spf_package_list\",\"label\":\"Enter package list (space or carriage-return separated)\",\"placeholder\":\"Enter one or more packages\",\"required\":true,\"type\":\"textarea\",\"visible\":[[\"$spf_package_install\",\"|\",\"$spf_package_load\"],\"\\u0026\",[\"$spf_package_list_type\",\"=\",\"List\"]]},{\"enabled\":[[\"$spf_package_install\",\"|\",\"$spf_package_load\"],\"\\u0026\",[\"$spf_package_list_type\",\"=\",\"File\"]],\"id\":\"spf_package_file_fqp\",\"label\":\"Select package file\",\"pathtype\":\"file\",\"placeholder\":\"\",\"required\":true,\"type\":\"path\",\"visible\":[[\"$spf_package_install\",\"|\",\"$spf_package_load\"],\"\\u0026\",[\"$spf_package_list_type\",\"=\",\"File\"]]}],\"id\":\"Install_load\",\"label\":\"Install / Load\",\"type\":\"page\"}],\"promptHierarchies\":[],\"showPageContentOnly\":true,\"syntaxversion\":\"1.3.0\",\"values\":{\"inputtable1\":{\"library\":\"\",\"table\":\"\"},\"outputtable1\":{\"library\":\"\",\"table\":\"\"},\"spf_custom_url\":\"\",\"spf_github_name\":\"\",\"spf_init_debug\":false,\"spf_init_fqp\":\"\",\"spf_init_type\":{\"value\":\"URL\"},\"spf_init_url\":\"https://raw.githubusercontent.com/yabwon/SAS_PACKAGES/refs/heads/main/SPF/SPFinit.sas\",\"spf_package_file_fqp\":\"\",\"spf_package_folder\":\"\",\"spf_package_install\":false,\"spf_package_list\":\"\",\"spf_package_list_type\":{\"value\":\"List\"},\"spf_package_load\":false,\"spf_package_update\":true,\"spf_repo\":{\"value\":\"SAS Packages\"},\"spf_skip_init\":false}}","templates":{"SAS":"%if &spf_init_debug %then %do;\r\n    %let spf_init_orig_symbolgen = %sysfunc(getoption(symbolgen));\r\n    %let spf_init_orig_mlogic = %sysfunc(getoption(mlogic));\r\n    %let spf_init_orig_mprint = %sysfunc(getoption(mprint));\r\n    %let spf_init_orig_mlogicnest = %sysfunc(getoption(mlogicnest));\r\n    %let spf_init_orig_mprintnest = %sysfunc(getoption(mprintnest));\r\n    options symbolgen mlogic mprint mlogicnest mprintnest;\r\n%end;\r\n\r\n%macro spf_init_step;\r\n    %local spf_init_sascontent \r\n           spf_package_sascontent \r\n           spf_package_file_sascontent\r\n           spf_init_file \r\n           spf_init_path\r\n           spf_repo_arg\r\n           spf_install_args\r\n           spf_init_fileref\r\n           re_valid_package_name\r\n           spf_package_file\r\n           spf_package_file_path\r\n           spf_package_file_fileref\r\n    ;\r\n    \r\n    %global spf_package_path;\r\n\r\n    /* Remove case-sensitivity */\r\n    %let spf_init_type          = %upcase(&spf_init_type);\r\n    %let spf_package_list_type  = %upcase(&spf_package_list_type);\r\n    %let spf_repo               = %upcase(&spf_repo);\r\n\r\n    /******* Error checking *******/\r\n\r\n    /* Must include a URL or file (this will fail later if the URL does not exist) */\r\n    %if (&spf_init_type = URL AND %bquote(&spf_init_url) =) OR\r\n        (&spf_init_type = FILE AND %bquote(&spf_init_fqp) =)   \r\n    %then %do;\r\n        %put ERROR: You must include a URL or file for SPFInit.sas.;\r\n        %abort;\r\n    %end;\r\n\r\n    /* Place to save SAS packages */\r\n    %if %bquote(&spf_package_folder) = %then %do;\r\n        %put ERROR: You must include a location to save SAS packages.;\r\n        %abort;\r\n    %end;\r\n\r\n    /* Things to check when installing or loading */\r\n    %if (&spf_package_install OR &spf_package_load) %then %do;\r\n\r\n        /* Must include a list of packages or a file if installing/loading */\r\n        %if (&spf_package_list_type = LIST AND %bquote(&spf_package_list) =) OR\r\n            (&spf_package_list_type = FILE AND %bquote(&spf_package_file_fqp)=)\r\n        %then %do;\r\n            %put ERROR: You must include a list or file of packages when the Install or Load option is selected.;\r\n            %abort;\r\n        %end;\r\n\r\n        /* Things to check only when installing */\r\n        %if &spf_package_install %then %do;\r\n\r\n            /* GitHub but no text added */\r\n            %if &spf_repo = GITHUB AND %bquote(&spf_github_name) = %then %do;\r\n                %put ERROR: You must include a GitHub username when the GitHub repo option is selected.;\r\n                %abort;\r\n            %end;\r\n\r\n            /* Custom but no text added (note: installPackage will already check if the URL is valid) */\r\n            %else %if &spf_repo = CUSTOM AND %bquote(&spf_custom_url) = %then %do;\r\n                %put ERROR: You must include a URL when the Custom repo option is selected.;\r\n                %abort;\r\n            %end;\r\n       %end;\r\n    %end;\r\n\r\n    /* Flags / path name cleanup */\r\n    %let spf_init_sascontent    = %sysevalf(%scan(%upcase(&spf_init_fqp), 1, /) = SASCONTENT:, boolean);\r\n    %let spf_package_sascontent = %sysevalf(%scan(%upcase(&spf_package_folder), 1, /) = SASCONTENT:, boolean);\r\n    %let spf_package_path       = %substr(&spf_package_folder, %index(&spf_package_folder, /)); /* Remove sascontent or sasserver from the start */\r\n\r\n    /* Randomize filename statement to init packages framework */\r\n    %let spf_init_fileref = spf_%upcase(%substr(%sysfunc(tranwrd(%sysfunc(uuidgen()),-,%str())), 1, 4));\r\n\r\n    /******* SPF Package Location *******/\r\n\r\n    /* If the package path is in SAS content, we need to:\r\n        1. Keep track of the original package path  in SAS Content\r\n        2. Reset the SPF package path to WORK */    \r\n    %if &spf_package_sascontent %then %do;\r\n        %let spf_package_path_sascontent = &spf_package_path;\r\n        %let spf_package_path            = %sysfunc(pathname(work));\r\n    %end;\r\n\r\n    filename packages \"&spf_package_path\";\r\n\r\n    /******* SPF Initialization File Location *******/\r\n\r\n    /* Create a filename statement for either a URL, SAS Content, or a physical path */\r\n    %if &spf_init_type = URL %then %do;\r\n        filename &spf_init_fileref url \"&spf_init_url\";\r\n    %end;\r\n\r\n        %else %if &spf_init_type = FILE %then %do;\r\n\r\n            /* sasserver:/foo/bar --> /foo/bar\r\n               sascontent:/foo/bar --> /foo/bar */\r\n            %let spf_init_fqp = %substr(&spf_init_fqp, %index(&spf_init_fqp, /));\r\n            %let spf_init_file = %scan(&spf_init_fqp, -1, /);\r\n            %let spf_init_path = %substr(&spf_init_fqp, 1, %eval(%length(&spf_init_fqp)-%length(&spf_init_file)-1));\r\n\r\n            %if &spf_init_sascontent %then %do;   \r\n                filename &spf_init_fileref filesrvc\r\n                    folderpath=%sysfunc(quote(&spf_init_path))\r\n                    filename=%sysfunc(quote(&spf_init_file))\r\n                ;\r\n            %end;\r\n\r\n                /* Otherwise, use the physical path on the filesystem */\r\n                %else %do;\r\n                    filename &spf_init_fileref %sysfunc(quote(&spf_init_fqp)); \r\n                %end;\r\n        %end;\r\n\r\n    /******* Run SPFInit.sas *******/\r\n\r\n    /* Run SPFInit.sas if it has not been initialized, but skip it if it has already been */\r\n    %if NOT (&spf_skip_init AND %sysmacexist(installPackage)) %then %do;\r\n\r\n        %include &spf_init_fileref;\r\n\r\n        %if &syserr LE 6 %then %do;\r\n\r\n            %if &spf_package_sascontent %then %do;\r\n                %put NOTE: SAS Packages are being stored in &spf_package_folder, but SAS packages must be on disk.;\r\n                %put NOTE: PACKAGES fileref has been reassigned to the WORK directory.;\r\n                %put NOTE: SPF Tools steps will automatically copy to/from SAS Content and WORK. Use %nrstr(%%)relocatePackage to manually transfer packages.;\r\n            %end;\r\n\r\n            %put NOTE: SAS Packages Framework initialized in &spf_package_path;\r\n        %end;\r\n            %else %do;\r\n                filename &spf_init_fileref clear;\r\n                %abort cancel;\r\n            %end;\r\n\r\n        filename &spf_init_fileref clear;\r\n    %end;\r\n        %else %put NOTE: The SAS Packages Framework has already been initialized. User requested to skip re-initialization. &spf_init_file was not run.;\r\n            \r\n    /******* Install or load *******/\r\n    %if &spf_package_install OR &spf_package_load %then %do;\r\n\r\n        %if &spf_package_list_type = FILE %then %do;\r\n        \r\n            /* Get filename and path:\r\n                - packages.txt\r\n                - /location/to/file \r\n            */\r\n            %let spf_package_file_sascontent = %sysevalf(%scan(%upcase(&spf_package_file_fqp), 1, /) = SASCONTENT:, boolean);\r\n            %let spf_package_file_fqp        = %substr(&spf_package_file_fqp, %index(&spf_package_file_fqp, /));\r\n            %let spf_package_file            = %scan(&spf_package_file_fqp, -1, /);\r\n            %let spf_package_file_path       = %substr(&spf_package_file_fqp, 1, %eval(%length(&spf_package_file_fqp)-%length(&spf_package_file)-1));\r\n            %let spf_package_file_fileref    = pkg_%upcase(%substr(%sysfunc(tranwrd(%sysfunc(uuidgen()),-,%str())), 1, 4));\r\n\r\n            %if &spf_package_file_sascontent %then %do;\r\n                filename &spf_package_file_fileref filesrvc\r\n                    filename=%sysfunc(quote(&spf_package_file))\r\n                    folderpath=%sysfunc(quote(&spf_package_file_path))\r\n                ;\r\n            %end;\r\n                %else %do;\r\n                    filename &spf_package_file_fileref %sysfunc(quote(&spf_package_file_fqp));\r\n                %end;\r\n        %end;\r\n\r\n        /* Sets valid package names:\r\n            package\r\n            package(version)\r\n            package[version]\r\n            package{version}\r\n            package==version\r\n\r\n            Version formats that are passed to the SPF use the brackets shown above. == is for convenience and is converted.\r\n        */\r\n        %let re_valid_package_name = ^[a-z0-9_]+(?:\\([0-9.]+\\)|\\{[0-9.]+\\}|\\[[0-9.]+\\]|==[0-9.]+)?$;\r\n\r\n       /* Creates a dataset of packages and versions, and creates macro variables for:\r\n          - A space and comma-separated list of packages with normalized versions: package1(version) package2(version) ...\r\n          - A space-separated list of packages without versions: package1 package2 ...\r\n\r\n          Code that runs depends on the method of input.\r\n       */  \r\n        data _null_;\r\n            length package_raw \r\n                   package \r\n                   version      $256 \r\n                   package_list $32767\r\n            ;\r\n\r\n            retain invalid_name_msg 0\r\n                package_list\r\n            ;\r\n                \r\n            /* Either loop through all the values in the manual list, or read from a file */\r\n            %if &spf_package_list_type = LIST %then %do;\r\n\r\n            do i = 1 to countw(\"&spf_package_list\", ,'S');\r\n                package_raw = strip(scan(\"&spf_package_list\", i, ,'S'));\r\n\r\n            %end;\r\n\r\n            /* Or read from a file */\r\n            %else %do;\r\n\r\n            infile &spf_package_file_fileref end=eof;        \r\n            input package_raw$;\r\n            package_raw = strip(package_raw);\r\n\r\n            %end;\r\n\r\n            /* Detect invalid patterns and ignore */\r\n            invalid_name = ( NOT prxmatch(\"/&re_valid_package_name/i\", strip(package_raw)) );\r\n\r\n            if invalid_name then do;\r\n                put 'WARNING: ' package_raw 'is an invalid package name format and will be ignored.';\r\n                invalid_name_msg = 1;\r\n            end;\r\n\r\n            else do;\r\n                    \r\n                ver_delim = findc(package_raw, '([{=');\r\n                package   = substr(package_raw, 1, ifn(ver_delim > 0, ver_delim-1, length(package_raw)) );\r\n                version   = compress(substr(package_raw, ver_delim+1), '.' ,'KD');\r\n\r\n                /* package1 package2(version) package3 ... */\r\n                package_list = catx(\r\n                    ' ', \r\n                    package_list, \r\n                    ifc(\r\n                        missing(version), \r\n                        package, \r\n                        cats(package, '(', version, ')') \r\n                    ) \r\n                );\r\n\r\n            end;\r\n\r\n            if NOT invalid_name then output;\r\n\r\n            /* End the do loop if reading from a list */\r\n            %if &spf_package_list_type = LIST %then %do;\r\n                \r\n            end;\r\n\r\n            %end;\r\n\r\n            /* Output the list at the end. EOF if reading from file, end of loop if not */ \r\n            %if &spf_package_list_type = FILE %then %do;\r\n\r\n            if eof then do;\r\n\r\n            %end;\r\n\r\n                /* Create valid formats for installPackage and loadPackages:\r\n                    - Space-separated list\r\n                    - Comma-separated list\r\n                    - Comma-separated list that removes versions: \r\n                        package1(6.7.0) package2(6.9.0) package3(4.2.0) --> package1 package2 package3\r\n                */\r\n                call symputx('spf_package_list_clean',     package_list, 'L');\r\n                call symputx('spf_package_list_clean_cs',  tranwrd(package_list, ' ', ','));\r\n                call symputx('spf_package_list_nover',     prxchange(\"s/\\([^)]*\\)//\", -1, package_list), 'L');\r\n\r\n                if invalid_name_msg  then put 'WARNING: Expected package name formats: ' /\r\n                    'package' /\r\n                    'package(version)' /\r\n                    'package[version]' /\r\n                    'package{version}' /\r\n                    'package==version' /\r\n                ;\r\n\r\n            %if &spf_package_list_type = FILE %then %do;\r\n\r\n            end;\r\n                    \r\n            %end;\r\n\r\n            keep package version;\r\n        run;\r\n\r\n        /******* Install *******/\r\n        %if &spf_package_install %then %do;\r\n    \r\n            /* Set installPackage options depending on the repo selected */\r\n            %if &spf_repo = PHARMAFOREST %then\r\n                %let spf_repo_arg = mirror=3\r\n            ;\r\n\r\n            %else %if &spf_repo = GITHUB %then\r\n                %let spf_repo_arg = github=&spf_github_name\r\n            ;\r\n\r\n            %else %if &spf_repo = CUSTOM %then %do;\r\n\r\n                /* Add an ending / if the user forgot - requirement for this option */\r\n                %if %substr(&spf_custom_url, %length(&spf_custom_url), 1) NE %str(/) %then\r\n                    %let spf_custom_url = &spf_custom_url/\r\n                ;\r\n\r\n                %let spf_repo_arg = sourcePath=&spf_custom_url;\r\n            %end;\r\n\r\n            %else %let spf_repo_arg=;\r\n\r\n            %let spf_install_args = replace=&spf_package_update;\r\n\r\n            /* Add future arguments here */\r\n            %if %length(&spf_repo_arg) > 0 %then \r\n                %let spf_install_args = &spf_install_args, &spf_repo_arg\r\n            ;\r\n\r\n            options spool;\r\n            \r\n            /* Install packages. Must be a space-separated list. */\r\n            %installPackage(&spf_package_list_clean, &spf_install_args);\r\n\r\n            /* Copy from WORK to SAS Content if SAS Content was specified */\r\n            %if &spf_package_sascontent %then %do;\r\n\r\n                %put NOTE: Copying packages from WORK to sascontent:&spf_package_path_sascontent;\r\n                \r\n                %relocatePackage(\r\n                    &spf_package_list_nover, \r\n                    target=&spf_package_path_sascontent, \r\n                    tDevice=FILESRVC,\r\n                    ignorePackagesFilerefCheck=1,\r\n                    checksum=%sysevalf(NOT &spf_package_update, boolean) /* Do not check hashes if spf_package_update is true */\r\n                );\r\n            %end;\r\n        %end;\r\n\r\n        /******* Load *******/\r\n        %if(&spf_package_load) %then %do;\r\n\r\n            /* If we have not run an install and a user is using SAS Content, then we \r\n               need to copy from SAS Content to WORK. Only copy the file over if it is newer. */\r\n            %if(NOT &spf_package_install AND &spf_init_sascontent) %then %do;\r\n                %put NOTE: Copying packages to WORK from sascontent:&spf_package_path_sascontent;\r\n\r\n                %relocatePackage(\r\n                    &spf_package_list_nover, \r\n                    source=&spf_package_path_sascontent,\r\n                    sDevice=FILESRVC,\r\n                    checksum=1\r\n                );\r\n            %end;\r\n\r\n            %loadPackages(&spf_package_list_clean_cs);\r\n        %end;\r\n\r\n    %end;\r\n\r\n%mend spf_init_step;\r\n%spf_init_step;\r\n\r\n%if &spf_init_debug %then %do;\r\n    options &spf_init_orig_symbolgen \r\n            &spf_init_orig_mlogic \r\n            &spf_init_orig_mlogicnest \r\n            &spf_init_orig_mprint \r\n            &spf_init_orig_mprintnest\r\n    ;\r\n%end;\r\n"}}
=======
{"creationTimeStamp":"2025-12-05T20:30:48.870099Z","createdBy":"Stu.Sztukowski@sas.com","modifiedTimeStamp":"2026-01-28T20:31:11.907662Z","modifiedBy":"Stu.Sztukowski@sas.com","id":"f5c86c1d-4813-4046-8bdc-b6bd4c024fca","name":"Initialize SAS Packages Framework.step","displayName":"Initialize SAS Packages Framework.step","localDisplayName":"Initialize SAS Packages Framework.step","links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca"},{"method":"POST","rel":"copy","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca/copy","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca/copy","responseType":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","uri":"/dataFlows/steps/f5c86c1d-4813-4046-8bdc-b6bd4c024fca","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":1,"version":2,"type":"code","flowMetadata":{"inputPorts":[{"name":"inputtable1","displayName":"inputtable1","localDisplayName":"inputtable1","minEntries":0,"maxEntries":1,"defaultEntries":0,"type":"table"}],"outputPorts":[{"name":"outputtable1","displayName":"outputtable1","localDisplayName":"outputtable1","minEntries":0,"maxEntries":1,"defaultEntries":0,"type":"table"}]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"init\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Initialize\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Initialize the SAS Package Framework and optionally install, update, and load SAS packages in bulk.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_debug\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Debug (Change dependency to view or hide)\",\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t1,\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t1\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_type\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Select a location for SPFInit.sas\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"URL\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"File\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_url\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"placeholder\": \"Enter a URL for spfinit.sas\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$spf_init_type\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"URL\"\n\t\t\t\t\t],\n\t\t\t\t\t\"regexp\": \"^(?:(http|ftp)(s)?:\\\\/\\\\/)?[\\\\w.-]+(?:\\\\.[\\\\w\\\\.-]+)+[\\\\w\\\\-\\\\._~:\\\\/?#[\\\\]@!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=.]+\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_init_fqp\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"pathtype\": \"file\",\n\t\t\t\t\t\"placeholder\": \"Select SPFInit.sas\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$spf_init_type\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"File\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_folder\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"Select a folder for SAS packages\",\n\t\t\t\t\t\"pathtype\": \"folder\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"outputtable1\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Used only to add an output port for connecting nodes\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t1,\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t0\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"inputtable1\",\n\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\"label\": \"Used only to add an input port for connecting nodes\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t1,\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t0\n\t\t\t\t\t],\n\t\t\t\t\t\"filter\": false,\n\t\t\t\t\t\"readonly\": false\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"Install_load\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Install / Load\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_install\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Install packages\",\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"indent\": 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_update\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Update Packages\",\n\t\t\t\t\t\"visible\": \"$spf_package_install\",\n\t\t\t\t\t\"indent\": 1\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_load\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Load packages\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text2\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"ℹ️ Packages stored in SAS Content will be copied to the WORK directory before loading.\",\n\t\t\t\t\t\"visible\": \"$spf_package_load\",\n\t\t\t\t\t\"indent\": 1\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_repo\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Package Repository\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"SAS Packages\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"PharmaForest\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"GitHub\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"Custom\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"$spf_package_install\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_github_name\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"placeholder\": \"Enter GitHub username or organization\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_repo\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"GitHub\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t\"$spf_package_install\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_custom_url\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"placeholder\": \"Enter URL for a package repository\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_repo\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"Custom\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t\"$spf_package_install\"\n\t\t\t\t\t],\n\t\t\t\t\t\"regexp\": \"^(?:(http|ftp)(s)?:\\\\/\\\\/)?[\\\\w.-]+(?:\\\\.[\\\\w\\\\.-]+)+[\\\\w\\\\-\\\\._~:\\\\/?#[\\\\]@!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=.]+\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_list_type\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Packages\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"List\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"File\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t],\n\t\t\t\t\t\"enabled\": [\n\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_list\",\n\t\t\t\t\t\"type\": \"textarea\",\n\t\t\t\t\t\"label\": \"Enter package list (space or carriage-return separated)\",\n\t\t\t\t\t\"placeholder\": \"Enter one or more packages\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_list_type\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"List\"\n\t\t\t\t\t\t]\n\t\t\t\t\t],\n\t\t\t\t\t\"enabled\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_list_type\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"List\"\n\t\t\t\t\t\t]\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"spf_package_file_fqp\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"Select package file\",\n\t\t\t\t\t\"pathtype\": \"file\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_list_type\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"File\"\n\t\t\t\t\t\t]\n\t\t\t\t\t],\n\t\t\t\t\t\"enabled\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_install\",\n\t\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t\t\"$spf_package_load\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"&\",\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$spf_package_list_type\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"File\"\n\t\t\t\t\t\t]\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"spf_init_debug\": false,\n\t\t\"spf_init_type\": {\n\t\t\t\"value\": \"URL\"\n\t\t},\n\t\t\"spf_init_url\": \"https://raw.githubusercontent.com/yabwon/SAS_PACKAGES/refs/heads/main/SPF/SPFinit.sas\",\n\t\t\"spf_init_fqp\": \"\",\n\t\t\"spf_package_folder\": \"\",\n\t\t\"outputtable1\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"inputtable1\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"spf_package_install\": false,\n\t\t\"spf_package_update\": true,\n\t\t\"spf_package_load\": false,\n\t\t\"spf_repo\": {\n\t\t\t\"value\": \"SAS Packages\"\n\t\t},\n\t\t\"spf_github_name\": \"\",\n\t\t\"spf_custom_url\": \"\",\n\t\t\"spf_package_list_type\": {\n\t\t\t\"value\": \"List\"\n\t\t},\n\t\t\"spf_package_list\": \"\",\n\t\t\"spf_package_file_fqp\": \"\"\n\t},\n\t\"promptHierarchies\": []\n}","localUi":"{\"pages\":[{\"children\":[{\"id\":\"text1\",\"text\":\"Initialize the SAS Package Framework and optionally install, update, and load SAS packages in bulk.\",\"type\":\"text\",\"visible\":\"\"},{\"id\":\"spf_init_debug\",\"label\":\"Debug (Change dependency to view or hide)\",\"type\":\"checkbox\",\"visible\":[1,\"=\",1]},{\"id\":\"spf_init_type\",\"items\":[{\"value\":\"URL\"},{\"value\":\"File\"}],\"label\":\"Select a location for SPFInit.sas\",\"type\":\"radiogroup\",\"visible\":\"\"},{\"id\":\"spf_init_url\",\"label\":\"\",\"placeholder\":\"Enter a URL for spfinit.sas\",\"regexp\":\"^(?:(http|ftp)(s)?:\\\\/\\\\/)?[\\\\w.-]+(?:\\\\.[\\\\w\\\\.-]+)+[\\\\w\\\\-\\\\._~:\\\\/?#[\\\\]@!\\\\$\\u0026'\\\\(\\\\)\\\\*\\\\+,;=.]+\",\"required\":true,\"type\":\"textfield\",\"visible\":[\"$spf_init_type\",\"=\",\"URL\"]},{\"id\":\"spf_init_fqp\",\"label\":\"\",\"pathtype\":\"file\",\"placeholder\":\"Select SPFInit.sas\",\"required\":true,\"type\":\"path\",\"visible\":[\"$spf_init_type\",\"=\",\"File\"]},{\"id\":\"spf_package_folder\",\"label\":\"Select a folder for SAS packages\",\"pathtype\":\"folder\",\"placeholder\":\"\",\"required\":true,\"type\":\"path\",\"visible\":\"\"},{\"id\":\"outputtable1\",\"label\":\"Used only to add an output port for connecting nodes\",\"placeholder\":\"\",\"required\":false,\"type\":\"outputtable\",\"visible\":[1,\"=\",0]},{\"filter\":false,\"id\":\"inputtable1\",\"label\":\"Used only to add an input port for connecting nodes\",\"placeholder\":\"\",\"readonly\":false,\"required\":false,\"type\":\"inputtable\",\"visible\":[1,\"=\",0]}],\"id\":\"init\",\"label\":\"Initialize\",\"type\":\"page\"},{\"children\":[{\"id\":\"spf_package_install\",\"indent\":0,\"label\":\"Install packages\",\"type\":\"checkbox\",\"visible\":\"\"},{\"id\":\"spf_package_update\",\"indent\":1,\"label\":\"Update Packages\",\"type\":\"checkbox\",\"visible\":\"$spf_package_install\"},{\"id\":\"spf_package_load\",\"label\":\"Load packages\",\"type\":\"checkbox\",\"visible\":\"\"},{\"id\":\"text2\",\"indent\":1,\"text\":\"ℹ️ Packages stored in SAS Content will be copied to the WORK directory before loading.\",\"type\":\"text\",\"visible\":\"$spf_package_load\"},{\"id\":\"spf_repo\",\"items\":[{\"value\":\"SAS Packages\"},{\"value\":\"PharmaForest\"},{\"value\":\"GitHub\"},{\"value\":\"Custom\"}],\"label\":\"Package Repository\",\"type\":\"radiogroup\",\"visible\":\"$spf_package_install\"},{\"id\":\"spf_github_name\",\"label\":\"\",\"placeholder\":\"Enter GitHub username or organization\",\"required\":true,\"type\":\"textfield\",\"visible\":[[\"$spf_repo\",\"=\",\"GitHub\"],\"\\u0026\",\"$spf_package_install\"]},{\"id\":\"spf_custom_url\",\"label\":\"\",\"placeholder\":\"Enter URL for a package repository\",\"regexp\":\"^(?:(http|ftp)(s)?:\\\\/\\\\/)?[\\\\w.-]+(?:\\\\.[\\\\w\\\\.-]+)+[\\\\w\\\\-\\\\._~:\\\\/?#[\\\\]@!\\\\$\\u0026'\\\\(\\\\)\\\\*\\\\+,;=.]+\",\"required\":true,\"type\":\"textfield\",\"visible\":[[\"$spf_repo\",\"=\",\"Custom\"],\"\\u0026\",\"$spf_package_install\"]},{\"enabled\":[\"$spf_package_install\",\"|\",\"$spf_package_load\"],\"id\":\"spf_package_list_type\",\"items\":[{\"value\":\"List\"},{\"value\":\"File\"}],\"label\":\"Packages\",\"type\":\"radiogroup\",\"visible\":[\"$spf_package_install\",\"|\",\"$spf_package_load\"]},{\"enabled\":[[\"$spf_package_install\",\"|\",\"$spf_package_load\"],\"\\u0026\",[\"$spf_package_list_type\",\"=\",\"List\"]],\"id\":\"spf_package_list\",\"label\":\"Enter package list (space or carriage-return separated)\",\"placeholder\":\"Enter one or more packages\",\"required\":true,\"type\":\"textarea\",\"visible\":[[\"$spf_package_install\",\"|\",\"$spf_package_load\"],\"\\u0026\",[\"$spf_package_list_type\",\"=\",\"List\"]]},{\"enabled\":[[\"$spf_package_install\",\"|\",\"$spf_package_load\"],\"\\u0026\",[\"$spf_package_list_type\",\"=\",\"File\"]],\"id\":\"spf_package_file_fqp\",\"label\":\"Select package file\",\"pathtype\":\"file\",\"placeholder\":\"\",\"required\":true,\"type\":\"path\",\"visible\":[[\"$spf_package_install\",\"|\",\"$spf_package_load\"],\"\\u0026\",[\"$spf_package_list_type\",\"=\",\"File\"]]}],\"id\":\"Install_load\",\"label\":\"Install / Load\",\"type\":\"page\"}],\"promptHierarchies\":[],\"showPageContentOnly\":true,\"syntaxversion\":\"1.3.0\",\"values\":{\"inputtable1\":{\"library\":\"\",\"table\":\"\"},\"outputtable1\":{\"library\":\"\",\"table\":\"\"},\"spf_custom_url\":\"\",\"spf_github_name\":\"\",\"spf_init_debug\":false,\"spf_init_fqp\":\"\",\"spf_init_type\":{\"value\":\"URL\"},\"spf_init_url\":\"https://raw.githubusercontent.com/yabwon/SAS_PACKAGES/refs/heads/main/SPF/SPFinit.sas\",\"spf_package_file_fqp\":\"\",\"spf_package_folder\":\"\",\"spf_package_install\":false,\"spf_package_list\":\"\",\"spf_package_list_type\":{\"value\":\"List\"},\"spf_package_load\":false,\"spf_package_update\":true,\"spf_repo\":{\"value\":\"SAS Packages\"}}}","templates":{"SAS":"%if &spf_init_debug %then %do;\r\n    %let spf_init_orig_symbolgen = %sysfunc(getoption(symbolgen));\r\n    %let spf_init_orig_mlogic = %sysfunc(getoption(mlogic));\r\n    %let spf_init_orig_mprint = %sysfunc(getoption(mprint));\r\n    %let spf_init_orig_mlogicnest = %sysfunc(getoption(mlogicnest));\r\n    %let spf_init_orig_mprintnest = %sysfunc(getoption(mprintnest));\r\n    options symbolgen mlogic mprint mlogicnest mprintnest;\r\n%end;\r\n\r\n%macro spf_init_step;\r\n    %local spf_init_sascontent \r\n           spf_package_sascontent \r\n           spf_package_file_sascontent\r\n           spf_init_file \r\n           spf_init_path\r\n           spf_repo_arg\r\n           spf_install_args\r\n           spf_init_fileref\r\n           re_valid_package_name\r\n           re_version_format\r\n           spf_package_file\r\n           spf_package_file_path\r\n           spf_package_file_fileref\r\n    ;\r\n    \r\n    %global spf_package_path_sascontent \r\n            spf_package_path\r\n    ;\r\n\r\n    /* Remove case-sensitivity */\r\n    %let spf_init_type          = %upcase(&spf_init_type);\r\n    %let spf_package_list_type  = %upcase(&spf_package_list_type);\r\n    %let spf_repo               = %upcase(&spf_repo);\r\n\r\n    /******* Error checking *******/\r\n\r\n    /* Must include a URL or file (this will fail later if the URL does not exist) */\r\n    %if (&spf_init_type = URL AND %bquote(&spf_init_url) =) OR\r\n        (&spf_init_type = FILE AND %bquote(&spf_init_fqp) =)   \r\n    %then %do;\r\n        %put ERROR: You must include a URL or file for SPFInit.sas.;\r\n        %abort;\r\n    %end;\r\n\r\n    /* Place to save SAS packages */\r\n    %if %bquote(&spf_package_folder) = %then %do;\r\n        %put ERROR: You must include a location to save SAS packages.;\r\n        %abort;\r\n    %end;\r\n\r\n    /* Things to check when installing or loading */\r\n    %if (&spf_package_install OR &spf_package_load) %then %do;\r\n\r\n        /* Must include a list of packages or a file if installing/loading */\r\n        %if (&spf_package_list_type = LIST AND %bquote(&spf_package_list) =) OR\r\n            (&spf_package_list_type = FILE AND %bquote(&spf_package_file_fqp)=)\r\n        %then %do;\r\n            %put ERROR: You must include a list or file of packages when the Install or Load option is selected.;\r\n            %abort;\r\n        %end;\r\n\r\n        /* Things to check only when installing */\r\n        %if &spf_package_install %then %do;\r\n\r\n            /* GitHub but no text added */\r\n            %if &spf_repo = GITHUB AND %bquote(&spf_github_name) = %then %do;\r\n                %put ERROR: You must include a GitHub username when the GitHub repo option is selected.;\r\n                %abort;\r\n            %end;\r\n\r\n            /* Custom but no text added (note: installPackage will already check if the URL is valid) */\r\n            %else %if &spf_repo = CUSTOM AND %bquote(&spf_custom_url) = %then %do;\r\n                %put ERROR: You must include a URL when the Custom repo option is selected.;\r\n                %abort;\r\n            %end;\r\n       %end;\r\n    %end;\r\n\r\n    /* Flags / path name cleanup */\r\n    %let spf_init_sascontent    = %sysevalf(%scan(%upcase(&spf_init_fqp), 1, /) = SASCONTENT:, boolean);\r\n    %let spf_package_sascontent = %sysevalf(%scan(%upcase(&spf_package_folder), 1, /) = SASCONTENT:, boolean);\r\n    %let spf_package_path       = %substr(&spf_package_folder, %index(&spf_package_folder, /)); /* Remove sascontent or sasserver from the start */\r\n\r\n    /* Randomize filename statement to init packages framework */\r\n    %let spf_init_fileref = spf_%upcase(%substr(%sysfunc(tranwrd(%sysfunc(uuidgen()),-,%str())), 1, 4));\r\n\r\n    /******* SPF Package Location *******/\r\n\r\n    /* If the package path is in SAS content, we need to:\r\n        1. Keep track of the original package path  in SAS Content\r\n        2. Reset the SPF package path to WORK */    \r\n    %if &spf_package_sascontent %then %do;\r\n        %let spf_package_path_sascontent = &spf_package_path;\r\n        %let spf_package_path            = %sysfunc(pathname(work));\r\n    %end;\r\n\r\n    filename packages \"&spf_package_path\";\r\n\r\n    /******* SPF Initialization File Location *******/\r\n\r\n    /* Create a filename statement for either a URL, SAS Content, or a physical path */\r\n    %if &spf_init_type = URL %then %do;\r\n        filename &spf_init_fileref url \"&spf_init_url\";\r\n    %end;\r\n\r\n        %else %if &spf_init_type = FILE %then %do;\r\n\r\n            /* sasserver:/foo/bar --> /foo/bar\r\n               sascontent:/foo/bar --> /foo/bar */\r\n            %let spf_init_fqp = %substr(&spf_init_fqp, %index(&spf_init_fqp, /));\r\n\r\n            %if &spf_init_sascontent %then %do;   \r\n            \r\n                /* Get filename and path:\r\n                   - SPFInit.sas\r\n                   - /location/to/file */\r\n\r\n                %let spf_init_file = %scan(&spf_init_fqp, -1, /);\r\n                %let spf_init_path = %substr(&spf_init_fqp, 1, %eval(%length(&spf_init_fqp)-%length(&spf_init_file)-1));\r\n                \r\n                filename &spf_init_fileref filesrvc\r\n                    folderpath=%sysfunc(quote(&spf_init_path))\r\n                    filename=%sysfunc(quote(&spf_init_file))\r\n                ;\r\n            %end;\r\n\r\n                /* Otherwise, use the physical path on the filesystem */\r\n                %else %do;\r\n                    filename &spf_init_fileref %sysfunc(quote(&spf_init_fqp)); \r\n                %end;\r\n        %end;\r\n\r\n    /******* Run SPFInit.sas *******/\r\n\r\n    /* Run SPFInit.sas */\r\n    %include &spf_init_fileref;\r\n\r\n    %if &syserr LE 6 %then %do;\r\n        %put NOTE: SAS Packages are being stored in &spf_package_folder, but SAS packages must be on disk.;\r\n        %put NOTE: PACKAGES fileref has been reassigned to the WORK directory.;\r\n        %put NOTE: SPF Tools steps will automatically copy to/from SAS Content and WORK. Use %nrstr(%%)relocatePackage to manually transfer packages.;\r\n        %put NOTE: SAS Packages Framework initialized in &spf_package_path;\r\n    %end;\r\n        %else %do;\r\n            filename &spf_init_fileref clear;\r\n            %abort cancel;\r\n        %end;\r\n\r\n    filename &spf_init_fileref clear;\r\n\r\n    /******* Install or load *******/\r\n    %if &spf_package_install OR &spf_package_load %then %do;\r\n\r\n        %if &spf_package_list_type = FILE %then %do;\r\n        \r\n            /* Get filename and path:\r\n                - packages.txt\r\n                - /location/to/file \r\n            */\r\n            %let spf_package_file_sascontent = %sysevalf(%scan(%upcase(&spf_package_file_fqp), 1, /) = SASCONTENT:, boolean);\r\n            %let spf_package_file_fqp        = %substr(&spf_package_file_fqp, %index(&spf_package_file_fqp, /));\r\n            %let spf_package_file            = %scan(&spf_package_file_fqp, -1, /);\r\n            %let spf_package_file_path       = %substr(&spf_package_file_fqp, 1, %eval(%length(&spf_package_file_fqp)-%length(&spf_package_file)-1));\r\n            %let spf_package_file_fileref    = pkg_%upcase(%substr(%sysfunc(tranwrd(%sysfunc(uuidgen()),-,%str())), 1, 4));\r\n\r\n            %if &spf_package_file_sascontent %then %do;\r\n                filename &spf_package_file_fileref filesrvc\r\n                    filename=%sysfunc(quote(&spf_package_file))\r\n                    folderpath=%sysfunc(quote(&spf_package_file_path))\r\n                ;\r\n            %end;\r\n                %else %do;\r\n                    filename &spf_package_file_fileref %sysfunc(quote(&spf_package_file_fqp));\r\n                %end;\r\n        %end;\r\n\r\n        /* Sets valid package names:\r\n            package\r\n            package(version)\r\n            package[version]\r\n            package{version}\r\n            package==version\r\n\r\n            Version formats that are passed to the SPF use the brackets shown above. == is for convenience and is converted.\r\n        */\r\n        %let re_valid_package_name = ^[a-z0-9_]+(?:\\([0-9.]+\\)|\\{[0-9.]+\\}|\\[[0-9.]+\\]|==[0-9.]+)?$;\r\n        %let re_version_format     = \\([^)]*\\)|\\{[^}]*\\}|\\[[^\\]]*\\]|\\s+;\r\n\r\n       /* Creates a dataset of packages and versions, and creates macro variables for:\r\n          - A space and comma-separated list of packages with normalized versions: package1(version) package2(version) ...\r\n          - A space-separated list of packages without versions: package1 package2 ...\r\n\r\n          Code that runs depends on the method of input.\r\n       */  \r\n        data _null_;\r\n            length package_raw \r\n                   package \r\n                   version      $256 \r\n                   package_list $32767\r\n            ;\r\n\r\n            retain invalid_name_msg 0\r\n                package_list\r\n            ;\r\n                \r\n            /* Either loop through all the values in the manual list, or read from a file */\r\n            %if &spf_package_list_type = LIST %then %do;\r\n\r\n            do i = 1 to countw(\"&spf_package_list\", ,'S');\r\n                package_raw = strip(scan(\"&spf_package_list\", i, ,'S'));\r\n\r\n            %end;\r\n\r\n            /* Or read from a file */\r\n            %else %do;\r\n\r\n            infile &spf_package_file_fileref end=eof;        \r\n            input package_raw$;\r\n            package_raw = strip(package_raw);\r\n\r\n            %end;\r\n\r\n            /* Detect invalid patterns and ignore */\r\n            invalid_name = ( NOT prxmatch(\"/&re_valid_package_name/i\", strip(package_raw)) );\r\n\r\n            if invalid_name then do;\r\n                put 'WARNING: ' package_raw 'is an invalid package name format and will be ignored.';\r\n                invalid_name_msg = 1;\r\n            end;\r\n\r\n            else do;\r\n                    \r\n                ver_delim = findc(package_raw, '([{=');\r\n                package   = substr(package_raw, 1, ifn(ver_delim > 0, ver_delim-1, length(package_raw)) );\r\n                version   = compress(substr(package_raw, ver_delim+1), '.' ,'KD');\r\n\r\n                /* package1 package2(version) package3 ... */\r\n                package_list = catx(\r\n                    ' ', \r\n                    package_list, \r\n                    ifc(\r\n                        missing(version), \r\n                        package, \r\n                        cats(package, '(', version, ')') \r\n                    ) \r\n                );\r\n\r\n            end;\r\n\r\n            if NOT invalid_name then output;\r\n\r\n            /* End the do loop if reading from a list */\r\n            %if &spf_package_list_type = LIST %then %do;\r\n                \r\n            end;\r\n\r\n            %end;\r\n\r\n            /* Output the list at the end. EOF if reading from file, end of loop if not */ \r\n            %if &spf_package_list_type = FILE %then %do;\r\n\r\n            if eof then do;\r\n\r\n            %end;\r\n\r\n                /* Create valid formats for installPackage and loadPackages:\r\n                    - Space-separated list\r\n                    - Comma-separated list\r\n                    - Comma-separated list that removes versions: \r\n                        package1(6.7.0) package2(6.9.0) package3(4.2.0) --> package1 package2 package3\r\n                */\r\n                call symputx('spf_package_list_clean',     package_list, 'L');\r\n                call symputx('spf_package_list_clean_cs',  tranwrd(package_list, ' ', ','));\r\n                call symputx('spf_package_list_nover',     prxchange(\"s/\\([^)]*\\)//\", -1, package_list), 'L');\r\n\r\n                if invalid_name_msg  then put 'WARNING: Expected package name formats: ' /\r\n                    'package' /\r\n                    'package(version)' /\r\n                    'package[version]' /\r\n                    'package{version}' /\r\n                    'package==version' /\r\n                ;\r\n\r\n            %if &spf_package_list_type = FILE %then %do;\r\n\r\n            end;\r\n                    \r\n            %end;\r\n\r\n            keep package version;\r\n        run;\r\n\r\n        /******* Install *******/\r\n        %if &spf_package_install %then %do;\r\n    \r\n            /* Set installPackage options depending on the repo selected */\r\n            %if &spf_repo = PHARMAFOREST %then\r\n                %let spf_repo_arg = mirror=3\r\n            ;\r\n\r\n            %else %if &spf_repo = GITHUB %then\r\n                %let spf_repo_arg = github=&spf_github_name\r\n            ;\r\n\r\n            %else %if &spf_repo = CUSTOM %then %do;\r\n\r\n                /* Add an ending / if the user forgot - requirement for this option */\r\n                %if %substr(&spf_custom_url, %length(&spf_custom_url), 1) NE %str(/) %then\r\n                    %let spf_custom_url = &spf_custom_url/\r\n                ;\r\n\r\n                %let spf_repo_arg = sourcePath=&spf_custom_url;\r\n            %end;\r\n\r\n            %else %let spf_repo_arg=;\r\n\r\n            %let spf_install_args = replace=&spf_package_update;\r\n\r\n            /* Add future arguments here */\r\n            %if %length(&spf_repo_arg) > 0 %then \r\n                %let spf_install_args = &spf_install_args, &spf_repo_arg\r\n            ;\r\n\r\n            options spool;\r\n            \r\n            /* Install packages. Must be a space-separated list. */\r\n            %installPackage(&spf_package_list_clean, &spf_install_args);\r\n\r\n            /* Copy from WORK to SAS Content if SAS Content was specified */\r\n            %if &spf_package_sascontent %then %do;\r\n\r\n                %put NOTE: Copying packages from WORK to sascontent:&spf_package_path_sascontent;\r\n                \r\n                %relocatePackage(\r\n                    &spf_package_list_nover, \r\n                    target=&spf_package_path_sascontent, \r\n                    tDevice=FILESRVC,\r\n                    ignorePackagesFilerefCheck=1,\r\n                    checksum=%sysevalf(NOT &spf_package_update, boolean) /* Do not check hashes if spf_package_update is true */\r\n                );\r\n            %end;\r\n        %end;\r\n\r\n        /******* Load *******/\r\n        %if(&spf_package_load) %then %do;\r\n\r\n            /* If we have not run an install and a user is using SAS Content, then we \r\n               need to copy from SAS Content to WORK. Only copy the file over if it is newer. */\r\n            %if(NOT &spf_package_install AND &spf_init_sascontent) %then %do;\r\n                %put NOTE: Copying packages to WORK from sascontent:&spf_package_path_sascontent;\r\n\r\n                %relocatePackage(\r\n                    &spf_package_list_nover, \r\n                    source=&spf_package_path_sascontent,\r\n                    sDevice=FILESRVC,\r\n                    checksum=1\r\n                );\r\n            %end;\r\n\r\n            %loadPackages(&spf_package_list_clean_cs);\r\n        %end;\r\n\r\n    %end;\r\n\r\n%mend spf_init_step;\r\n%spf_init_step;\r\n\r\n%if &spf_init_debug %then %do;\r\n    options &spf_init_orig_symbolgen \r\n            &spf_init_orig_mlogic \r\n            &spf_init_orig_mlogicnest \r\n            &spf_init_orig_mprint \r\n            &spf_init_orig_mprintnest\r\n    ;\r\n%end;\r\n"}}
>>>>>>> 615b1bb83828e48458e1cc3f216d3ab2d388962d
