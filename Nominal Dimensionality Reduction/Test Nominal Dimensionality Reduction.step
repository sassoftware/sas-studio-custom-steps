{"name": "Auto_Generated_b95ad343-da63-4bb8-a720-922ac00d8a91", "creationTimeStamp": null, "modifiedTimeStamp": null, "createdBy": null, "modifiedBy": null, "displayName": null, "localDisplayName": null, "properties": null, "links": null, "metadataVersion": null, "version": null, "type": "code", "flowMetadata": null, "ui": "{\"showPageContentOnly\": true, \"pages\": [{\"id\": \"params\", \"type\": \"page\", \"label\": \"Parameters\", \"children\": [{\"id\": \"section_input_params\", \"type\": \"section\", \"label\": \"Input Parameters\", \"open\": true, \"children\": [{\"id\": \"input_table\", \"type\": \"inputtable\", \"label\": \"Input table\", \"required\": true, \"placeholder\": \"\", \"visible\": \"\", \"filter\": false}, {\"id\": \"nominal_vars\", \"type\": \"columnselector\", \"label\": \"Nominal variables (space separated)\", \"include\": null, \"order\": false, \"columntype\": \"a\", \"max\": null, \"min\": 1, \"visible\": \"\", \"table\": \"input_table\"}, {\"id\": \"other_vars\", \"type\": \"columnselector\", \"label\": \"Other variables to copy (space separated)\", \"include\": null, \"order\": false, \"columntype\": \"a\", \"max\": null, \"min\": 1, \"visible\": \"\", \"table\": \"input_table\"}, {\"id\": \"num_dimensions\", \"type\": \"numstepper\", \"label\": \"Number of dimensions\", \"required\": false, \"integer\": false, \"min\": null, \"max\": null, \"stepsize\": 1}, {\"id\": \"method\", \"type\": \"dropdown\", \"label\": \"Method\", \"items\": [{\"value\": \"MCA\", \"label\": \"MCA\"}, {\"value\": \"LPCA\", \"label\": \"LPCA\"}], \"required\": true, \"placeholder\": \"\", \"visible\": \"\"}, {\"id\": \"prefix\", \"type\": \"textfield\", \"label\": \"Output prefix\", \"placeholder\": \"mca_rv_\", \"required\": false}, {\"id\": \"output_table\", \"type\": \"outputtable\", \"label\": \"Output table\", \"required\": true, \"placeholder\": \"\", \"visible\": \"\", \"filter\": false}, {\"id\": \"rstore_name\", \"type\": \"outputtable\", \"label\": \"RStore name\", \"required\": true, \"placeholder\": \"\", \"visible\": \"\", \"filter\": false}]}]}, {\"id\": \"about\", \"type\": \"page\", \"label\": \"About\", \"children\": [{\"id\": \"section_about_intro\", \"type\": \"section\", \"label\": \"Nominal Dimensionality Reduction\", \"open\": true, \"visible\": \"\", \"children\": [{\"id\": \"section_about_intro_text\", \"type\": \"text\", \"text\": \"This custom step performs nominal dimension reduction using PROC NOMINALDR. This custom step adds runtime guards, helpful defaults and a small cleanup routine for macro variables.\", \"visible\": \"\"}, {\"id\": \"section_about_parameters\", \"type\": \"section\", \"label\": \"Parameters\", \"open\": false, \"visible\": \"\", \"children\": [{\"id\": \"section_about_parameters_input\", \"type\": \"section\", \"label\": \"Input Parameters\", \"open\": false, \"children\": [{\"id\": \"section_about_parameters_input_text\", \"type\": \"text\", \"text\": \"1. Input table(input table, required): select an input dataset\\n2. Select nominal variables (column selector, required): select one or more nominal variables to reduce. \\n3. Other variables to copy (column selector, optional): select any other variables to copy to the output table.\\n4. Method (list box, default MCA): select either MCA or LPCA. \\n\", \"visible\": \"\"}]}, {\"id\": \"section_about_parameters_output\", \"type\": \"section\", \"label\": \"Output parameters\", \"open\": true, \"visible\": \"\", \"children\": [{\"id\": \"section_about_parameters_output_text\", \"type\": \"text\", \"text\": \"1. Number of dimensions (number stepper, optional): specify the number of dimensions to reduce to. \\n2. Output prefix (text field, optional): specify a prefix for the output variables. \\n3. Output table (output port, required): specify an output table. \\n4. RStore name (output port, required): select an RStore name.  \", \"visible\": \"\"}]}]}, {\"id\": \"section_about_version\", \"type\": \"section\", \"label\": \"About this step\", \"open\": true, \"children\": [{\"id\": \"version_text\", \"type\": \"text\", \"text\": \"Version: 1.0.0 (22DEC2025)\\nContact: Sundaresh Sankaran (Sundaresh.sankaran@sas.com)\"}]}]}]}], \"syntaxversion\": \"1.3.0\", \"values\": {}}", "templates": {"SAS": "/* SAS templated code goes here */\n\n/* -------------------------------------------------------------------------------------------*\n   Nominal Dimensionality Reduction - Version 1.0.0\n\n   This program uses the SAS procedure NOMINALDR to perform dimensionality reduction on\n   nominal variables in a dataset. It supports two methods: Multiple Correspondence Analysis (MCA)\n   and Logistic Principal Component Analysis (LPCA). The program also allows for the inclusion of\n   additional variables and saving the results in a specified output table or rstore.\n\n   Author: Sundaresh Sankaran (original)\n   Refactor: Polished after AI-assisted automation\n   Version: 1.0.0 (22DEC2025)\n*-------------------------------------------------------------------------------------------- */\n\n%put NOTE: Starting Nominal Dimensionality Reduction program...;\n\n/* -------------------------------------------------------------------------------------------*\n    User Parameters\n    \n    The parameters below allow customization of the aggregation operation,\n    including the input file path, aggregation functions, columns to aggregate,\n    grouping columns, and output table.\n    \n    Users can modify these parameters to suit their specific data and analysis needs.\n* -------------------------------------------------------------------------------------------- */\n\n/* input_table takes in the name of the input data set from an input port */\n%let input_table=SASHELP.CARS;\n\n/* nominal_vars takes in the list of nominal variables to be reduced through a column selector */\n%let nominal_vars=Make Model Type Origin DriveTrain;\n\n/* other_vars takes in the list of other variables to copy to output through a column selector */\n%let other_vars=MSRP Invoice EngineSize Cylinders Horsepower MPG_City MPG_Highway Weight Wheelbase Length;\n\n/* num_dimensions takes in the number of dimensions specified for the analysis */\n%let num_dimensions=8;\n\n/* method takes in the method to be used for the analysis, either MCA or LPCA*/\n%let method=MCA;\n\n/* prefix takes in the prefix for the output variables */\n%let prefix=mca_rv_;\n\n/* output_table takes in the name of the output data set with reduced dimensions */\n%let output_table=WORK.NEWCARS;\n\n/* rstore_name takes in the name of the RStore file to save the model binary.  */\n%let rstore_name=MCASTORE;\n\n/* -----------------------------------------------------------------------------------------*\n   Macros\n\n   The macros below follow the structural conventions used in SAS programs for custom step:\n\n   - small utility macros for runtime triggers and error flags\n   - a focused macro for execution of the main step\n*------------------------------------------------------------------------------------------*/\n\n/* -------------------------------------------------------------------------------------------* \n   Macro to initialize a run-time trigger global macro variable to run SAS Studio Custom Steps. \n   A value of 1 (the default) enables this custom step to run.  A value of 0 (provided by \n   upstream code) sets this to disabled.\n\n   Input:\n   1. triggerName: The name of the runtime trigger you wish to create. Ensure you provide a \n      unique value to this parameter since it will be declared as a global variable.\n\n   Output:\n   2. &triggerName : A global variable which takes the name provided to triggerName.\n*-------------------------------------------------------------------------------------------- */;\n\n%macro _create_runtime_trigger(triggerName);\n  %global &triggerName.;\n  %if %sysevalf(%superq(&triggerName.)=, boolean) %then %do;\n    %let &triggerName.=1;\n  %end;\n%mend _create_runtime_trigger;\n\n/* -----------------------------------------------------------------------------------------* \n   Macro to create an error flag for capture during code execution.\n\n   Input:\n      1. errorFlagName: The name of the error flag you wish to create. Ensure you provide a \n         unique value to this parameter since it will be declared as a global variable.\n      2. errorFlagDesc: A description to add to the error flag.\n\n    Output:\n      1. &errorFlagName : A global variable which takes the name provided to errorFlagName.\n      2. &errorFlagDesc : A global variable which takes the name provided to errorFlagDesc.\n*------------------------------------------------------------------------------------------ */\n\n%macro _create_error_flag(errorFlagName, errorFlagDesc);\n  %global &errorFlagName.;\n  %let &errorFlagName.=0;\n  %global &errorFlagDesc.;\n%mend _create_error_flag;\n\n/* -----------------------------------------------------------------------------------------* \n   Macro to safely delete a macro symbol if it exists.\n\n   Input:\n      1. sym: The name of the macro symbol to delete.\n*------------------------------------------------------------------------------------------ */\n%macro _safe_symdel(sym);\n  %if %symexist(&sym) %then %do; %symdel &sym; %end;\n%mend _safe_symdel;\n\n/*-----------------------------------------------------------------------------------------*\n   EXECUTION CODE MACRO \n\n   _ndr prefix stands for Nominal Dimensionality Reduction. This macro contains the main \n   logic for the Nominal Dimensionality Reduction step. It includes validation, default \n   settings, and the execution of the main step.\n*------------------------------------------------------------------------------------------*/\n%macro _ndr_execution_code;\n\n/* Initialize runtime trigger and error flags */\n    %_create_error_flag(_ndr_error_flag, _ndr_error_desc);\n\n   %if &_ndr_error_flag. = 0 %then %do;\n        %if %sysevalf(%superq(input_table)=, boolean) %then %do; \n            %let _ndr_error_flag=1; \n            %let _ndr_error_desc=Input table is required.; \n            %put ERROR: &_ndr_error_desc.; \n        %end;\n   %end;\n   %if &_ndr_error_flag. = 0 %then %do;\n        %if %sysevalf(%superq(nominal_vars)=, boolean) %then %do; \n            %let _ndr_error_flag=1; \n            %let _ndr_error_desc=At least one nominal variable is required.; \n            %put ERROR: &_ndr_error_desc.; \n        %end;\n   %end;\n   %if &_ndr_error_flag. = 0 %then %do;\n        %if %sysevalf(%superq(num_dimensions)=, boolean) %then %do; \n            %let num_dimensions=8; \n            %put NOTE: num_dimensions not provided, defaulting to 8.; \n        %end;\n   %end;\n   %if &_ndr_error_flag. = 0 %then %do;\n        proc NOMINALDR data=&input_table. dimension=&num_dimensions. method=%upcase(&method.) prefix=&prefix.;\n            input &nominal_vars. / level=nominal;\n            %if %sysevalf(%superq(other_vars)=, boolean) %then %do; %end; %else %do; output out=&output_table. copyVars=(&other_vars.); %end;\n            %if %sysevalf(%superq(rstore_name)=, boolean) %then %do; %end; %else %do; savestate RSTORE=&rstore_name.; %end;\n        run;\n   %end;\n\n%mend _ndr_execution_code;\n\n/*-----------------------------------------------------------------------------------------*\n   END MACROS\n*------------------------------------------------------------------------------------------*/\n/*-----------------------------------------------------------------------------------------*\n   EXECUTION CODE\n*------------------------------------------------------------------------------------------*/\n   \n/*-----------------------------------------------------------------------------------------*\n   Create Runtime Trigger\n*------------------------------------------------------------------------------------------*/\n\n%_create_runtime_trigger(_ndr_run_trigger);\n%put NOTE: Run trigger is &_ndr_run_trigger.;\n\n/*-----------------------------------------------------------------------------------------*\n   Execute \n*------------------------------------------------------------------------------------------*/\n/* Basic validation and defaults */\n%if &_ndr_run_trigger. = 1 %then %do;\n    %_ndr_execution_code;\n%end;\n%else %do;\n  %put NOTE: This step has been disabled by runtime trigger.;\n%end;\n\n%put NOTE: Final summary;\n%put NOTE: Status of error flag - &_ndr_error_flag. ;\n%put &_ndr_error_desc.;\n%put NOTE: Error desc - &_ndr_error_desc. ;\n\n/*-----------------------------------------------------------------------------------------*\n   END EXECUTION CODE\n*------------------------------------------------------------------------------------------*/\n/*-----------------------------------------------------------------------------------------*\n   Clean up existing macro variables and macro definitions.\n*------------------------------------------------------------------------------------------*/\n\n\n\n%put NOTE: Nominal Dimensionality Reduction program completed.;\n\n%_safe_symdel(_ndr_run_trigger);\n\n%sysmacdelete _create_runtime_trigger;\n%sysmacdelete _create_error_flag;\n\n%_safe_symdel(_ndr_error_flag);\n%_safe_symdel(_ndr_error_desc);\n%sysmacdelete _safe_symdel;"}}