{"creationTimeStamp":"2022-06-15T12:29:11.329Z","modifiedTimeStamp":"2022-06-15T12:29:11.329Z","createdBy":"sinsrn","modifiedBy":"sinsrn","name":"Python - Activate a virtual environment.step","displayName":"Python - Activate a virtual environment.step","localDisplayName":"Python - Activate a virtual environment.step","properties":{},"links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a","uri":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a","uri":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a","uri":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a","uri":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a","uri":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a","uri":"/dataFlows/steps/17712f50-fe7f-4ef7-8674-083b2c4c4e9a","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":0.0,"version":2,"type":"code","flowMetadata":{"inputPorts":[],"outputPorts":[]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"page1\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Parameters\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"venv\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"Provide a path to an existing virtual environment.\",\n\t\t\t\t\t\"placeholder\": \"e.g. /mnt/path/to/venv/folder\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"page2\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Python - Activate a virtual environment\\n\\nThe \\\"Python - Activate a virtual environment\\\" custom step helps users activate a virtual Python environment, which had been created earlier using a virtualenv package.  Activating a virtual Python environment leads to the current Python interpreter operating in the context of this new environment. \\n\\nProvide a path to the folder which contains a virtual environment created earlier, which would typically be on a shared file system which is mounted to the SAS Studio session.  A common area would be the /mnt/ folder.\\n\\nCreated / contact : Sundaresh Sankaran (sundaresh.sankaran@sas.com) and Ali Aiello (ali.aiello@sas.com) \\n\\nVersion : 1.0.   May 20 2022\\n\\nFor more details, refer https://blogs.sas.com/content/subconsciousmusings/2022/05/16/python-a-la-carte/\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"venv\": \"\"\n\t},\n\t\"promptHierarchies\": []\n}","templates":{"SAS":"/* SAS templated code goes here */\n\n\nproc python;\n\nsubmit;\n\nimport os\nvenv=SAS.symget(\"venv\")\n\npyt=os.environ[\"PROC_PYPATH\"]\n\nmpt=SAS.symget(\"MAIN_PYTH\")\n\nif mpt==\"\":\n    SAS.symput(\"MAIN_PYTH\",str(pyt))\n\nactivate_this_file = os.path.join(venv,\"bin\",\"activate_this.py\")\nexec(open(activate_this_file).read(), {'__file__': str(activate_this_file)})\nSAS.symput(\"TEMP_PYTH\",str(os.path.join(venv,\"bin\",\"python3\")))\n\nendsubmit;\n\nquit;\nproc python terminate;\nquit;\n\noptions set=PROC_PYPATH=\"&TEMP_PYTH.\";\n\n%put &TEMP_PYTH.;\n%put &MAIN_PYTH.;\n\nproc python;\nsubmit;\nimport os\npyt=SAS.symget(\"TEMP_PYTH\")\nprint(\"Environment activated: {pyt}\".format(pyt=pyt))\nendsubmit;\nquit;"}}