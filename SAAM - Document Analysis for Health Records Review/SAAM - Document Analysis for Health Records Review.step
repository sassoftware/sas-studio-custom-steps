{"description":"","displayName":"SAAM - Document Analysis for Health Records Review.step","eTag":"\"kizydc3dak\"","flowMetadata":{"inputPorts":[],"outputPorts":[]},"metadataVersion":1,"name":"SAAM - Document Analysis for Health Records Review.step","properties":{},"templates":{"SAS":"/***************************************************************************************************************\n\n   SCRIPT:       SAAM - Document Analysis for Health Records Review.step\n\n   PURPOSE:\n   Custom Step driver for the Health Records Review (HRR) medical information extraction pipeline. \n   Validates UI-provided server paths, assigns the compiled MRR macro catalog, builds a JSON \n   `userConfig` payload, writes it to a temporary file, and executes `%mrr_information_extraction`. \n   After execution, assigns an output libref (or imports flat files) so results are accessible in SAS.\n\n   KEY FEATURES:\n   -------------\n   - Validates that UI selections are SAS Server–based (rejects SAS Content selections)\n   - Derives `_hrr_src_filepath`, `_hrr_export_dirpath`, `_hrr_astore_dirpath`,\n     `_hrr_macro_catalog_dirpath` from `sasserver:`-prefixed parameters\n   - Gracefully assigns/refreshes compiled macro catalog (MSTORED/SASMSTORE)\n   - Dynamically constructs the MRR `userConfig` JSON (import/global/std sections)\n   - Normalizes and defaults optional settings:\n       * SDA vs SAS input mode routing\n       * `flag_invalid_dates` and `enable_bookmarking` to JSON booleans\n       * `min_valid_date` defaults to 1930-01-01\n       * `max_valid_date` defaults to CURRENTDATE\n       * converts ISO dates to SAS DATE9. strings for config\n   - Writes `userConfig` JSON to a temp fileref and passes its resolved path to MRR\n   - Post-processes exports by assigning an output libref based on export type:\n       * sas7bdat → direct libname to export directory\n       * sashdat  → CASLIB + libname CAS (if session exists)\n       * json     → JSON libname to nested results file\n       * csv/xls/xlsx → PROC IMPORT of expected flat files into a temp libref\n\n   REQUIRED MACRO VARIABLES (UI-provided):\n   ---------------------------------------\n   - _hrr_input_source_type            [SDA:MAPPINGFILE or SAS:SASDATASET]\n   - _hrr_source_data_file             [sasserver:<path>]\n   - _hrr_output_export_directory      [sasserver:<path>]\n   - _hrr_output_export_file_type      [csv | json | xls | xlsx | sas7bdat | sashdat]\n   - _hrr_astore_directory             [sasserver:<path>]\n   - _hrr_macro_catalog_directory      [sasserver:<path>]\n   - _hrr_colnames_sas_r1_c1           [document_id column (SAS input mode)]\n   - _hrr_colnames_sas_r1_c2           [document_text column (SAS input mode)]\n   - _hrr_colnames_sas_r1_c3           [document_page_number column (SAS input mode)]\n   - _hrr_debug_level                  [DEBUG | INFO]\n\n   OPTIONAL FLAGS & FORMATTERS (UI-provided):\n   ------------------------------------------\n   - _hrr_standardize_casing           [Lowcase | Upcase | Propcase]\n   - _hrr_enable_bookmarking           [YES | NO]  -> converted to true/false for JSON\n   - _hrr_flag_invalid_dates           [YES | NO]  -> converted to true/false for JSON\n   - _hrr_min_valid_date               [ISO8601 date; defaults to 1930-01-01]\n   - _hrr_max_valid_date               [ISO8601 date; defaults to CURRENTDATE]\n   - _hrr_date_format                  [SAS date format, e.g., DATE9.]\n\n   DERIVED / INTERNAL MACRO VARIABLES:\n   -----------------------------------\n   - _hrr_input_source                 [SDA or SAS]\n   - _hrr_src_filepath                 [resolved source file path]\n   - _hrr_export_dirpath               [resolved export directory path]\n   - _hrr_astore_dirpath               [resolved astore directory path]\n   - _hrr_macro_catalog_dirpath        [resolved macro catalog directory path]\n   - _hrr_sda_fpath                    [populated when input source is SDA]\n   - _hrr_sas_fpath                    [populated when input source is SAS]\n   - _hrr_user_config_json             [full JSON config string]\n   - _hrr_usercfg_fpath                [resolved temp config filepath]\n   - _hrr_output_libref                [_HRROUT_]\n   - _hrr_catalog_libref               [_HRRCAT_]\n\n   OUTPUTS:\n   --------\n   - Temp `userConfig` file (FILEREF: usercfg) containing JSON payload\n   - `%mrr_information_extraction(userConfig=<tempfile>, astoreDirpath=<dir>, loglevel=<level>)`\n   - Exported results written to `_hrr_export_dirpath` in the selected format\n   - Output made available via libref `_HRROUT_` (direct libname / CAS / JSON / PROC IMPORT)\n\n   DEPENDENCIES:\n   -------------\n   - Compiled MRR macro catalog accessible from `_hrr_macro_catalog_directory`\n     (loaded via MSTORED/SASMSTORE)\n   - `%mrr_information_extraction` (MRR pipeline macro)\n   - `%mrr_cleanup_global_mvars` (cleanup utility)\n   - CAS session availability required for `sashdat` post-processing path\n\n   HISTORY:\n   --------\n   - 2025-10-01 | mupago |              | Initial creation\n   - 2025-11-25 | winado | AAIMDEV-5070 | Added logic to gracefully assign SAS macro catalog\n   - 2025-11-25 | winado | AAIMDEV-5069 | Refactored to use astoreDirpath instead of rootDirpath\n   - 2025-12-03 | mupago | AAIMDEV-5070 | Updated parameters for astore dirpath and macro catalog\n   - 2025-12-19 | winado | AAIMDEV-5071 | Updates to design layout and code modifications for consistency\n   - 2026-01-12 | mupago | AAIMDEV-5070 | Updated to use kscan function in reset_assign_exportLibref macro  \n   - 2026-01-14 | mupago | AAIMDEV-5070 | Added clean up code from _template to delete user defined macro \n                                          variables and functions  \n   - 2026-01-21 | mupago | AAIMDEV-5071 | Used _hrr_export_dirpath as parameter value for reset_assign_exportLibref macro\n   - 2026-01-21 | mupago | AAIMDEV-5071 | Modified %sysmacdelete splitting into multiple statements to avoid extraneous text warning\n   - 2026-01-21 | mupago | AAIMDEV-5071 | Fixed a bug for cas_sess_exist evaluation to use %let instead of %put\n   - 2026-01-21 | mupago | AAIMDEV-5071 | Used sysevalf function to perform numerical comparison for cas session macro variable\n   - 2026-01-21 | mupago | AAIMDEV-5071 | Added code to explicitly remove MRR_OUT from CAS to avoid conflict with output libref\n   - 2026-01-21 | mupago | AAIMDEV-5071 | Added code for lifting sashdat tables into memory for sashdat output file type\n   - 2026-01-22 | mupago | AAIMDEV-5071 | Fixed code for proc import to use guessingrows only when dbms is csv\n********************************************************************************************************************/\n\ncas;\ncas casauto;\ncaslib _all_ assign;\n/* options casdatalimit=8G; */\n/* options mprint mprintnest mlogic symbolgen mautosource mlogicnest; */\n\n/* Uncomment to debug */\n/* %put \"_hrr_input_source_type selected is:\" &_hrr_input_source_type;\n%put \"_hrr_colnames_sas_r1_c1 selected is:\" &_hrr_colnames_sas_r1_c1;\n%put \"_hrr_colnames_sas_r1_c2 selected is:\" &_hrr_colnames_sas_r1_c2;\n%put \"_hrr_colnames_sas_r1_c3 selected is:\" &_hrr_colnames_sas_r1_c3;\n%put \"_hrr_source_data_file selected is:\" &_hrr_source_data_file;\n%put \"_hrr_output_export_directory selected is:\" &_hrr_output_export_directory;\n%put \"_hrr_output_export_file_type selected is:\" &_hrr_output_export_file_type;\n%put \"_hrr_astore_directory selected is:\" &_hrr_astore_directory;\n%put \"_hrr_macro_catalog_directory selected is:\" &_hrr_macro_catalog_directory;\n%put \"_hrr_standardize_casing selected is:\" &_hrr_standardize_casing;\n%put \"_hrr_flag_invalid_dates selected is:\" &_hrr_flag_invalid_dates;\n%put \"_hrr_enable_bookmarking selected is:\" &_hrr_enable_bookmarking;\n%put \"_hrr_min_valid_date selected is:\" &_hrr_min_valid_date;\n%put \"_hrr_max_valid_date selected is:\" &_hrr_max_valid_date;\n%put \"_hrr_date_format selected is:\" &_hrr_date_format;\n%put \"_hrr_debug_level selected is:\" &_hrr_debug_level; */\n\n/* Specify where to make output accessible from after processing completes */\n%let _hrr_output_libref = _HRROUT_;\n%let _hrr_catalog_libref = _HRRCAT_;\n\n/* Check that macro catalog and model directory exist and are accessible */\ndata _null_;\n\n    * Check that the user provided Astore file directory is on the SAS server and not in SAS Content;\n    mode_1 = kscan(\"&_hrr_astore_directory.\", 1, ':');\n\n    if mode_1 EQ 'sasserver' then do;\n        call symputx('_hrr_astore_dirpath', kscan(\"&_hrr_astore_directory.\", -1, ':'));\n    end;\n    else do;\n        putLog 'ERROR: Please ensure that the selected source directory is on the SAS server.';\n        abort 40;\n    end;\n\n    * Check that the user provided macro catalog directory is on the SAS server and not in SAS Content;\n    mode_2 = kscan(\"&_hrr_macro_catalog_directory.\", 1, ':');\n    \n    if mode_2 EQ 'sasserver' then do;\n        call symputx('_hrr_macro_catalog_dirpath', kscan(\"&_hrr_macro_catalog_directory.\", -1, ':'));\n    end;\n    else do;\n        putLog 'ERROR: Please ensure that the selected export directory is on the SAS server.';\n        abort 41;\n    end;\n\nrun;\n\n/* Logic to gracefully establish SAS macro catalog accessibility */\n%macro mrr_assign_sasmacro_catalog(catalogLibref=, dirpath=);\n\n    %put \"dirpath passed into macro catalog assignment module is: \" &dirpath.;\n    %put \"catalogLibref passed into macro catalog assingment module is:\" &catalogLibref.;    \n\n    /* Ensure catalogLibref meets length requirement */\n    %if %klength(&catalogLibref.) > 8 %then %do;\n        %put ERROR: SAS macro catalog catalogLibref <&catalogLibref> supplied to mrr_assign_sasmacro_catalog must be <= 8 characters long!;\n        %return;\n    %end;\n\n    /* Determine if SAS macro catalog already exists from prior execution */\n    proc sql noprint; \n        select count(distinct libname) \n        into: mrr_sasmacro_catalog_exists \n        from dictionary.libnames \n        where kupcase(kstrip(libname)) = kupcase(kstrip(\"&catalogLibref\"));\n    quit;\n\n    /* If it exists then clear it to avoid error */\n    %if &mrr_sasmacro_catalog_exists. = 1 %then %do;\n        %sysmstoreclear;\n    %end;\n\n    /* Now assign and load compiled macro catalog */\n    libname &catalogLibref. &dirpath.;\n    options mstored sasmstore=\"&catalogLibref\";\n\n    /* Check if it exists now after assignment */\n    proc sql; \n        select count(distinct libname) \n        into: mrr_sasmacro_catalog_exists \n        from dictionary.libnames \n        where kupcase(kstrip(libname)) = kupcase(kstrip(\"&catalogLibref\"));\n    quit;\n\n    %put \"mrr_sasmacro_catalog_exists macro variable is now set to: \" &mrr_sasmacro_catalog_exists. \" after the library invocation step\";\n\n%mend mrr_assign_sasmacro_catalog;\n\n/* Assign and load compiled macro catalog */\n%mrr_assign_sasmacro_catalog(catalogLibref=&_hrr_catalog_libref., dirpath=\"&_hrr_macro_catalog_dirpath.\");\n\n/* Validate input file exists and is accessible */\ndata _null_;\n\n    * Extract the first argument from the Input Source Type parameter to be passed on to the json config file;\n    call symputx('_hrr_input_source', kscan(\"&_hrr_input_source_type.\", 1, ':'));\n\n    * Check that the user provided a source (input) directory on the SAS server and not in SAS Content;\n    mode_1 = kscan(\"&_hrr_source_data_file.\", 1, ':');\n    if mode_1 EQ 'sasserver' then do;\n        call symputx('_hrr_src_filepath', kscan(\"&_hrr_source_data_file.\", -1, ':'));\n    end;\n    else do;\n        putLog 'ERROR: Please ensure that the selected source directory is on the SAS server.';\n        abort 42;\n    end;\n\n    * Check that the user provided a export (output) directory on the SAS server and not in SAS Content;\n    mode_2 = kscan(\"&_hrr_output_export_directory.\", 1, ':');\n\n    if mode_2 EQ 'sasserver' then do;\n        call symputx('_hrr_export_dirpath', kscan(\"&_hrr_output_export_directory.\", -1, ':'));\n    end;\n    else do;\n        putLog 'ERROR: Please ensure that the selected export directory is on the SAS server.';\n        abort 43;\n    end;\nrun;\n\n%put \"Source file path assigned value is:\" &_hrr_src_filepath;\n%put \"Export directory path assigned value is:\" &_hrr_export_dirpath;\n\n/* Conditionally populate the filepath for either the SAS or SDA specific input data mode */\n\n%if %kupcase(&_hrr_input_source) = SDA %then %do;\n    %let _hrr_sda_fpath = &_hrr_src_filepath;\n    %let _hrr_sas_fpath =;\n%end;\n\n%if %kupcase(&_hrr_input_source) = SAS %then %do;\n    %let _hrr_sas_fpath = &_hrr_src_filepath;\n    %let _hrr_sda_fpath=;\n%end;\n\n%if %kupcase(_hrr_flag_invalid_dates) = YES %then %do;\n    %let _hrr_flag_invalid_dates = true;\n%end;\n\n%else %do;\n    %let _hrr_flag_invalid_dates = false;\n%end;\n\n%if %kupcase(_hrr_enable_bookmarking) = YES %then %do;\n    %let _hrr_enable_bookmarking = true;\n%end;\n%else %do;\n    %let _hrr_enable_bookmarking = false;\n%end;\n\n%if &_hrr_min_valid_date = %then %do; \n    %let _hrr_min_valid_date = 1930-01-01; \n%end;\n\n%if &_hrr_max_valid_date = %then %do; \n    %let _hrr_max_valid_date = CURRENTDATE;\n%end;\n\n/* Convert character ISO date to SAS date and reformat */\ndata _null_;\n    minValidDate_num = input(\"&_hrr_min_valid_date\", yymmdd10.);\n    formatted_MinValidDate = put(minValidDate_num, date9.);\n    call symputx('_hrr_min_valid_date', formatted_MinValidDate);\nrun;\n\n/* Convert character ISO date to SAS date and reformat */\n%if &_hrr_max_valid_date ne CURRENTDATE %then %do;\n    data _null_;\n        maxValidDate_num = input(\"&_hrr_max_valid_date\", yymmdd10.);\n        formatted_MaxValidDate = put(maxValidDate_num, date9.);\n        call symputx('_hrr_max_valid_date', formatted_MaxValidDate);\n    run;\n%end;\n\n/* %put \"_hrr_sda_fpath populated as:\" &_hrr_sda_fpath;\n%put \"_hrr_sas_fpath populated as:\" &_hrr_sas_fpath;\n%put \"_hrr_flag_invalid_dates populated as:\" &_hrr_flag_invalid_dates;\n%put \"_hrr_enable_bookmarking populated as:\" &_hrr_enable_bookmarking;\n%put \"_hrr_min_valid_date populated as:\" &_hrr_min_valid_date;\n%put \"_hrr_max_valid_date populated as:\" &_hrr_max_valid_date; */\n\n/* Dynamically create the user config json string in a sas macro using the parameters passed on from the Custom Step */\n\n%let _hrr_user_config_json=\n{\n    \"global\": [\n        {\n            \"main\": [\n                {\n                    \"id\": \"1000\",\n\t                \"datamode\": \"ECE\",\n                    \"persist_scoring_data\": \"true\"\n                }\n            ],\n            \"parms\": [\n                {\n                    \"sub\": [\n                        {\n                            \"id\": \"1001\",\n                            \"name\": \"output_flat_files\",\n                            \"type\": \"flag\",\n                            \"value\": \"true\"\n                        },\n                        {\n                            \"id\": \"1002\",\n                            \"name\": \"flat_file_dirpath\",\n                            \"type\": \"directory_path\",\n                            \"value\": \"%superq(_hrr_export_dirpath)\"\n                        },\n                        {\n                            \"id\": \"1003\",\n                            \"name\": \"flat_file_format\",\n                            \"type\": \"file_format\",\n                            \"value\": \"%superq(_hrr_output_export_file_type)\"\n                        }\n                    ]\n                }\n            ]\n        }\n    ],\n    \"import\": [\n        {\n            \"main\": [\n                {\n                    \"id\": \"2000\",\n                    \"import_source\": \"%superq(_hrr_input_source)\"\n                }\n            ],\n            \"parms\": [\n                {\n                    \"id\": \"2010\",\n                    \"source\": \"SDA\",\n                    \"datatype\": \"OCRFILE\",\n                    \"method\": \"MAPPINGFILE\",\n                    \"description\": \"Loads OCR output produced by the SAS Document Analysis (SDA) process\",\n                    \"sda_filepath\": \"%superq(_hrr_sda_fpath)\"\n                },\n                {\n                    \"id\": \"2020\",\n                    \"source\": \"SAS\",\n                    \"datatype\": \"DATASET\",\n                    \"method\": \"DATAFILE\",\n                    \"description\": \"Loads input dataset from a SAS datafile\",\n                    \"sas_filepath\": \"%superq(_hrr_sas_fpath)\",\n                    \"sub\": [\n                        {\n                            \"id\": \"2021\",\n                            \"name\": \"document_id\",\n                            \"type\": \"column_name\",\n                            \"value\": \"%superq(_hrr_colnames_sas_r1_c1)\"\n                        },\n                        {\n                            \"id\": \"2022\",\n                            \"name\": \"document_text\",\n                            \"type\": \"column_name\",\n                            \"value\": \"%superq(_hrr_colnames_sas_r1_c2)\"\n                        },\n                        {\n                            \"id\": \"2023\",\n                            \"name\": \"document_page_number\",\n                            \"type\": \"column_name\",\n                            \"value\": \"%superq(_hrr_colnames_sas_r1_c3)\"\n                        }\n                    ]\n                }\n            ]\n        }\n    ],\n    \"std\": [\n        {\n            \"main\": [\n                {\n                    \"id\": \"3000\",\n                    \"standardized_casing\": \"%superq(_hrr_standardize_casing)\",\n                    \"enable_bookmarking\": \"%superq(_hrr_enable_bookmarking)\"\n                }\n            ],\n            \"parms\": [\n                {\n                    \"sub\": [\n                        {\n                            \"id\": \"3001\",\n                            \"name\": \"date_format\",\n                            \"type\": \"sas_format\",\n                            \"value\": \"%superq(_hrr_date_format)\"\n                        },\n                        {\n                            \"id\": \"3002\",\n                            \"name\": \"flag_invalid_dates\",\n                            \"type\": \"flag\",\n                            \"value\": \"%superq(_hrr_flag_invalid_dates)\"\n                        },\n                        {\n                            \"id\": \"3003\",\n                            \"name\": \"min_valid_date\",\n                            \"type\": \"string\",\n                            \"value\": \"%superq(_hrr_min_valid_date)\"\n                        },\n                        {\n                            \"id\": \"3004\",\n                            \"name\": \"max_valid_date\",\n                            \"type\": \"string\",\n                            \"value\": \"%superq(_hrr_max_valid_date)\"\n                        }\n                    ]\n                }\n            ]\n        }\n    ]\n}\n;\n\n/* Assign a temporary fileref named 'usercfg' */\nfilename usercfg temp;\n\n/* Write json content to the target directory location */ \ndata _null_ ;\n    file usercfg ;\n    length jsonstring $32767 ;\n    jsonstring = symget('_hrr_user_config_json') ;\n    jsonlen = klength(ktrim(kleft(jsonstring))) ;\n    put jsonstring $varying. jsonlen ;\nrun ;\n\n/* Write out the temp file to the log just to verify the contents */\ndata _null_;\n    infile usercfg;\n\tinput ;\n    put \"Start of the user config file in the log\";\n\tput _infile_;\n    put \"End of the user config file in the log\";\nrun;\n\n/* Extract the fullpath of the temp file to a macro variable to pass as a parameter to the macro function */\n%let _hrr_usercfg_fpath = %sysfunc(pathname(usercfg));\n\n%put \"The _hrr_usercfg_fpath macro value assigned as:\" &_hrr_usercfg_fpath;\n\n/* Execute MRR end-to-end information extraction */\n%mrr_information_extraction(userConfig=&_hrr_usercfg_fpath, astoreDirpath=&_hrr_astore_dirpath., loglevel=&_hrr_debug_level.); \n\n/* Clear the temporary fileref - usercfg */\nfilename usercfg clear;\n\n/* Proc import macro for xls and xlsx extensions */\n%macro proc_import(exportFileType=, exportDirpath=, exportLibref=, tableName=);\n        proc import\n            datafile=\"&exportDirpath./&tableName..&exportFileType\"\n            out=&exportLibref..&tableName.\n            dbms=&exportFileType.\n            replace;\n            getnames=YES;\n            %if %kupcase(&exportFileType)=CSV %then %do;\n                %put NOTE: Using guessingrows option to determine column types with exportFileType as: &exportFileType;\n                guessingrows=5000;\n            %end;\n        run;\n%mend;\n\n/* Reset / Clear exportLibref if it already exists and assign using params */\n%macro reset_assign_exportLibref(exportFileType=, exportDirpath=, exportLibref=);\n\n    %local saslib_exists cas_sess_exist jsonlib_exists;\n\n    /* Remove 'sasserver:' prefix from macrovar if it exists */\n        /* %let exportDirpath = %sysfunc(scan(&_hrr_output_export_directory., -1, ':'));  */\n\n    %put &=exportFileType;\n    %put &=exportDirpath;\n    %put &=exportLibref;\n\n    /* Check if the exportLibref is currently assigned and unassign it, if needed */\n    proc sql noprint;\n        select count(distinct libname) \n            into: libref_exists \n            from dictionary.libnames \n            where kupcase(kstrip(libname))=kupcase(kstrip(\"&exportLibref\"))\n        ;\n    quit;\n\n    %if &libref_exists. > 0 %then %do;\n        %put NOTE: Clearing existing exportLibref=&exportLibref.;\n        libname &exportLibref. clear;\n    %end;\n\n    /* Assign libref based on export file type */\n\n    %if &exportFileType.=sas7bdat %then %do;\n        libname &exportLibref. \"&exportDirpath\";\n        %put NOTE: sas7bdat output library created with libref - &exportLibref.;\n    %end;\n\n    %else %if &exportFileType.=sashdat %then %do;\n        \n        %let cas_sess_exist = %sysfunc(sessfound(&_SESSREF_));\n\n        /* Use function to perform numerical comparison */\n        %if %sysevalf(&cas_sess_exist. > 0) %then %do;\n\n            %put CAS session already exists with a return code: &cas_sess_exist.;\n\n            /* Explicitly drop cas library by name - MRR_OUT to avoid conflict with path based caslib _HRROUT_ */\n            proc cas;\n                table.dropCaslib / caslib=\"MRR_OUT\";\n            quit;\n\n            caslib mycaslib sessref=&_SESSREF_ datasource=(srctype=\"path\") path=\"&exportDirpath.\";\n\n            libname &exportLibref. cas caslib=mycaslib;\n            \n            /* Lift all the sashdat output tables in the caslib into memory */\n            /* CAUTION: sashdat files names in casdata= option are case-sensitive and needs\n            to be specified with exact case with which they are located on the server */\n\n            proc casutil incaslib=\"mycaslib\" outcaslib=\"mycaslib\";\n                load casdata=\"mrr_final_keyvalues.sashdat\" casout=\"MRR_FINAL_KEYVALUES\" replace;\n                load casdata=\"mrr_final_docsummary.sashdat\" casout=\"MRR_FINAL_DOCSUMMARY\" replace;\n                load casdata=\"mrr_final_pagesummary.sashdat\" casout=\"MRR_FINAL_PAGESUMMARY\" replace;\n                load casdata=\"mrr_source_data_mapping.sashdat\" casout=\"MRR_SOURCE_DATA_MAPPING\" replace;\n                load casdata=\"mrr_final_classification.sashdat\" casout=\"MRR_FINAL_CLASSIFICATION\" replace;\n            quit;\n\n            %put NOTE: sashdat output library created with libref - &exportLibref.;\n        %end;\n    %end;\n\n    %else %if &exportFileType.=json %then %do;\n        libname &exportLibref. json \"&exportDirpath./MRR_NESTED_RESULTS.json\";\n        %put NOTE: json output library created with libref - &exportLibref.;\n    %end;\n\n    %else %if &exportFileType.=csv or &exportFileType.=xls or &exportFileType.=xlsx %then %do;\n\n        libname &exportLibref. \"/tmp\";\n        %proc_import(exportFileType=&exportFileType., exportDirpath=&exportDirpath., exportLibref=&exportLibref., tableName=MRR_FINAL_KEYVALUES);\n        %proc_import(exportFileType=&exportFileType., exportDirpath=&exportDirpath., exportLibref=&exportLibref., tableName=MRR_FINAL_DOCSUMMARY);\n        %proc_import(exportFileType=&exportFileType., exportDirpath=&exportDirpath., exportLibref=&exportLibref., tableName=MRR_FINAL_PAGESUMMARY);\n        %proc_import(exportFileType=&exportFileType., exportDirpath=&exportDirpath., exportLibref=&exportLibref., tableName=MRR_SOURCE_DATA_MAPPING);\n        %proc_import(exportFileType=&exportFileType., exportDirpath=&exportDirpath., exportLibref=&exportLibref., tableName=MRR_FINAL_CLASSIFICATION);\n\n    %end;\n\n%mend reset_assign_exportLibref;\n\n%reset_assign_exportLibref(exportFileType=&_hrr_output_export_file_type., exportDirpath=&_hrr_export_dirpath., exportLibref=&_hrr_output_libref.);\n\n/* Clean up global macro variables with common prefix */\n\n%let _mrr_debug_flag_ = N;\n%mrr_cleanup_global_mvars(mvarPrefix=_hrr);\n%symdel _mrr_debug_flag_;\n\n/* Need to assign _mrr_debug_flag_ to avoid error within mrr_cleanup_global_mvars macro */\n\n/* Clear macro catalog libref - not working for some reason */\n\n/* %sysmstoreclear; */\n\n%put NOTE: The SDA-HRR medical information extraction process has completed successfully - output can be accessed from the _HRROUT_ libref.;\n\n/* Delete user-defined SAS macros and SAS macro variables using nowarn option.  */\n\n%symdel _hrr_astore_dirpath _hrr_macro_catalog_dirpath _hrr_input_source _hrr_src_filepath _hrr_export_dirpath _hrr_min_valid_date _hrr_max_valid_date / NOWARN;\n\n%sysmacdelete proc_import;\n%sysmacdelete reset_assign_exportLibref; "},"type":"code","ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"_mrrOptionsPage\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Options\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_hrr_options_page_text\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"SAS Studio Custom Step for executing the SAS Document Analysis (SDA) for Health Records Review (HRR) information extraction process. \\n\\nThe process takes as input a collection of unstructured medical text records and produces structured outputs including page-level document classifications and key-value pairs of interest.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_hrr_Configuration\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Deployment configuration (Required)\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_config_notes\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"First specify where the SDA-HRR model artifacts have been deployed by your administrator. These locations must be accessible from within SAS Studio.\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_macro_catalog_directory\",\n\t\t\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\t\t\"label\": \"SDA-HRR macro catalog directory path:\",\n\t\t\t\t\t\t\t\"pathtype\": \"folder\",\n\t\t\t\t\t\t\t\"placeholder\": \"Folder where your sasmacr.sas7bcat resides\",\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_astore_directory\",\n\t\t\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\t\t\"label\": \"SDA-HRR model file(s) directory path:\",\n\t\t\t\t\t\t\t\"pathtype\": \"folder\",\n\t\t\t\t\t\t\t\"placeholder\": \"Folder where your astore model files reside\",\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_hrr_Main_Inputs\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Input & output data (Required)\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_main_input_notes\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"At a minimum, users must specify the SAS or SDA datafile to be processed, the output directory to export results, and the desired file type format for the exported results. If using a SAS dataset as input, users must also provide a column mapping. If executing against SDA output, this is not necessary.\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_input_source_type\",\n\t\t\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\t\t\"label\": \"Select input source type:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"SAS : SAS dataset file (sas7bdat or sashdat)\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"SDA : SAS document analysis OCR output file (csv or xlsx)\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_colnames_sas\",\n\t\t\t\t\t\t\t\"type\": \"optiontable\",\n\t\t\t\t\t\t\t\"label\": \"Column name mapping:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"tabletype\": \"authorboth\",\n\t\t\t\t\t\t\t\"initialrowcount\": 1,\n\t\t\t\t\t\t\t\"min\": null,\n\t\t\t\t\t\t\t\"max\": null,\n\t\t\t\t\t\t\t\"showcolumnlabels\": true,\n\t\t\t\t\t\t\t\"columns\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"id\": \"_hrr_document_id\",\n\t\t\t\t\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\t\t\t\t\"label\": \" Document ID field:\",\n\t\t\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\t\t\"value\": \"docid\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"id\": \"_hrr_document_text\",\n\t\t\t\t\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\t\t\t\t\"label\": \"Document text field:\",\n\t\t\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\t\t\"value\": \"doctext\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"id\": \"_hrr_document_page_number\",\n\t\t\t\t\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\t\t\t\t\"label\": \"Document page number:\",\n\t\t\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\t\t\"value\": null\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\t\t\"$_hrr_input_source_type\",\n\t\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\t\"SAS : SAS dataset file (sas7bdat or sashdat)\"\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"repeatref\": null,\n\t\t\t\t\t\t\t\"enabled\": [\n\t\t\t\t\t\t\t\t\"$_hrr_input_source_type\",\n\t\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\t\"SAS : SAS dataset file (sas7bdat or sashdat)\"\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_sas_colname_notes\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"NOTE: When using a SAS dataset as input, if your Document ID field contains repeated values then you must also provide a Document page number column to ensure unique ID's are available. If Document ID values are unique then Document page number is optional.\",\n\t\t\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\t\t\"$_hrr_input_source_type\",\n\t\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\t\"SAS : SAS Dataset File (sas7bdat or sashdat)\"\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"enabled\": [\n\t\t\t\t\t\t\t\t\"$_hrr_input_source_type\",\n\t\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\t\"SAS : SAS Dataset File (sas7bdat or sashdat)\"\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_source_data_file\",\n\t\t\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\t\t\"label\": \"Input source file:\",\n\t\t\t\t\t\t\t\"pathtype\": \"file\",\n\t\t\t\t\t\t\t\"placeholder\": \"Select the input file to be processed\",\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_output_export_directory\",\n\t\t\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\t\t\"label\": \"Export directory path:\",\n\t\t\t\t\t\t\t\"pathtype\": \"folder\",\n\t\t\t\t\t\t\t\"placeholder\": \"Select the export directory to write output files\",\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_output_export_file_type\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Export file type:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"csv\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"xlsx\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"xls\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"sas7bdat\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"sashdat\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"json\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"Select the output file type desired\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_hrr_additional_options\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Additional settings (Optional)\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_standardize_casing\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Standardized key-value casing:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"lowcase\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"upcase\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"propcase\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_flag_invalid_dates\",\n\t\t\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\t\t\"label\": \"Flag invalid dates?\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"Yes\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"No\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_min_valid_date\",\n\t\t\t\t\t\t\t\"type\": \"datetime\",\n\t\t\t\t\t\t\t\"label\": \"Minimum valid date: (Default: Jan 1, 1930)\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\t\t\"min\": \"1930-01-01\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_max_valid_date\",\n\t\t\t\t\t\t\t\"type\": \"datetime\",\n\t\t\t\t\t\t\t\"label\": \"Maximum valid date: (Default: CURRENTDATE)\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\t\t\"min\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_date_format\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Desired date format: (Default: MMDDYY10.)\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"DATE9.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"DDMMYY.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"DDMMYY10.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"DDMMYYD.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"DDMMYYD10.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"DDMMYYN8.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"DDNNTTP10.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"DDMMYYS10.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"MMDDYY.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"MMDDYY10.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"MMDDYYD.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"MMDDYYD10.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"MMDDYYP.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"MMDDYYP10.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"MMDDYYS.\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"MMDDYYS10.\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_enable_bookmarking\",\n\t\t\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\t\t\"label\": \"Enable bookmarking? (Only supported when using SDA as input source)\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"Yes\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"No\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_hrr_debug_level\",\n\t\t\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\t\t\"label\": \"Desired log level:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"INFO\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"DEBUG\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_hrr_final_note_message\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"NOTE: Final output will be routed to the _HRROUT_ libref corresponding to the specified Export directory path.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"_mrrAboutPage\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mrr_about_page_text\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"SAAM - Document Analysis for Health Records Review (Version: V1.2)\\n=========================================================\\n\\nThis step automates the ingestion and analysis of unstructured health records to extract clinically relevant information quickly and accurately. An intuitive workflow standardizes the identification of key medical findings, improving consistency across reviews. By reducing manual effort and variability, organizations can accelerate health record processing and support more efficient, reliable clinical and operational decisions. \\n\\nThis step enables to run a full batch job, without the need to write any code. It can also be run inside a flow with the \\\"OCR - Document Analysis - Execute Batch OCR Process\\\" custom step to seamlessly integrate the OCR and HRR processes to run in sequence. Advanced optical character recognition (OCR) converts scanned documents and digitized medical records into structured, tabular data with optional annotated PDFs for review.\\n\\nThe location of the generated output will be displayed after running this step.\\n\\n## Pre-requisites:\\n \\n-   SAS Viya 2025.12 or later \\n-   A license for SAS Document Analysis is required\\n\\n## Change Log:\\n\\n* Version 1.2 (22JAN2026)\\n-----------------------------\\n\\n  * Updated the Program code with few code fixes\\n\\n* Version 1.1 (14JAN2026)\\n-----------------------------\\n\\n  * Updated the Options page with additional required parameters for the user to populate to execute the step\\n  * Updated the About page with more description explaining the usage of the step\\n  * Updated the Program tab with logic to handle conflicts with output libref name \\n  * Added cleanup code in the Program tab towards the end of completion of the step to delete macro variables that were created by the step\\n  * Updated the UI field names and column names to use proper casing and end of line punctuation (: or ?)\\n\\n* Version 1.0 (08DEC2025)\\n-----------------------------\\n\\n  * Initial version\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"_hrr_macro_catalog_directory\": \"\",\n\t\t\"_hrr_astore_directory\": \"\",\n\t\t\"_hrr_input_source_type\": {\n\t\t\t\"value\": \"SDA : SAS document analysis OCR output file (csv or xlsx)\"\n\t\t},\n\t\t\"_hrr_colnames_sas\": null,\n\t\t\"_hrr_source_data_file\": \"\",\n\t\t\"_hrr_output_export_directory\": \"\",\n\t\t\"_hrr_output_export_file_type\": null,\n\t\t\"_hrr_standardize_casing\": {\n\t\t\t\"value\": \"lowcase\"\n\t\t},\n\t\t\"_hrr_flag_invalid_dates\": {\n\t\t\t\"value\": \"Yes\"\n\t\t},\n\t\t\"_hrr_min_valid_date\": \"\",\n\t\t\"_hrr_max_valid_date\": null,\n\t\t\"_hrr_date_format\": {\n\t\t\t\"value\": \"MMDDYY10.\"\n\t\t},\n\t\t\"_hrr_enable_bookmarking\": {\n\t\t\t\"value\": \"No\"\n\t\t},\n\t\t\"_hrr_debug_level\": {\n\t\t\t\"value\": \"INFO\"\n\t\t}\n\t},\n\t\"promptHierarchies\": []\n}"}