{"creationTimeStamp":"2024-06-14T18:32:15.360143Z","createdBy":"Ethan.Kavanaugh@sas.com","modifiedTimeStamp":"2026-02-11T08:30:24.352437Z","modifiedBy":"Remco.Gooijer@sas.com","id":"5998a470-a880-4f3b-bb26-be549c1b0612","name":"CAS - Load to CAS.step","displayName":"CAS - Load to CAS.step","localDisplayName":"CAS - Load to CAS.step","links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612","uri":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612","uri":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612","uri":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612","uri":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612"},{"method":"POST","rel":"copy","href":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612/copy","uri":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612/copy","responseType":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612","uri":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612","uri":"/dataFlows/steps/5998a470-a880-4f3b-bb26-be549c1b0612","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":1,"version":2,"type":"code","flowMetadata":{"inputPorts":[{"name":"_input","displayName":"_input","localDisplayName":"_input","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table"}],"outputPorts":[{"name":"_output","displayName":"_output","localDisplayName":"_output","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table"}]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"page1\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Options\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_input\",\n\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\"label\": \"Input Table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_memfmt\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Set Memory Format:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"DVR\",\n\t\t\t\t\t\t\t\"label\": \"DVR\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"INHERIT\",\n\t\t\t\t\t\t\t\"label\": \"INHERIT\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"STANDARD\",\n\t\t\t\t\t\t\t\"label\": \"STANDARD\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_append\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Append to CAS table.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_compress\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Compress CAS table.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_promote\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Promote CAS table.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_convert\",\n\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\"label\": \"Convert CHAR to VARCHAR:\",\n\t\t\t\t\t\"include\": null,\n\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\"columntype\": \"c\",\n\t\t\t\t\t\"max\": null,\n\t\t\t\t\t\"min\": null,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"table\": \"_input\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_listing\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Display CAS table metadata.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_output\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Output Table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"page2\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text2\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\\nLoad to CAS custom step\\n=====================\\n\\nThis custom step can: \\n    - Load your input table into CAS.\\n    - Append your input table into your CAS table.\\n    - Create the CAS table, in case it doesn't exist.\\n    - Set memory format (for the newly created table).\\n    - Promote your CAS table \\n    - Display table metadata in your log\\n    - Convert CHAR columns into VARCHAR columns.\\n    - Compress the target CAS table.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"section1\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Changelog\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"* Version 1.3 (11FEB2026)\\n    - Added the optional CHAR to VARCHAR conversion and the possibility to compress the CAS table.\\n    - First public release.\\n\\n* Version 1.2\\n    - Bas Altorf added the memory format functionality for the CAS table.\\n    - Internal release\\n\\n* Version 1.1\\n    - Added append functionality.\\n    - Internal release\\n\\n* Version 1.0\\n    - Initial version.\\n    - Internal release\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"_input\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"_memfmt\": {\n\t\t\t\"value\": \"INHERIT\",\n\t\t\t\"label\": \"INHERIT\"\n\t\t},\n\t\t\"_append\": false,\n\t\t\"_compress\": false,\n\t\t\"_promote\": true,\n\t\t\"_convert\": [],\n\t\t\"_listing\": false,\n\t\t\"_output\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t}\n\t}\n}","localUi":"{\"pages\":[{\"children\":[{\"id\":\"_input\",\"label\":\"Input Table:\",\"placeholder\":\"\",\"required\":true,\"type\":\"inputtable\",\"visible\":\"\"},{\"id\":\"_memfmt\",\"items\":[{\"label\":\"DVR\",\"value\":\"DVR\"},{\"label\":\"INHERIT\",\"value\":\"INHERIT\"},{\"label\":\"STANDARD\",\"value\":\"STANDARD\"}],\"label\":\"Set Memory Format:\",\"type\":\"radiogroup\",\"visible\":\"\"},{\"id\":\"_append\",\"label\":\"Append to CAS table.\",\"type\":\"checkbox\",\"visible\":\"\"},{\"id\":\"_compress\",\"label\":\"Compress CAS table.\",\"type\":\"checkbox\",\"visible\":\"\"},{\"id\":\"_promote\",\"label\":\"Promote CAS table.\",\"type\":\"checkbox\",\"visible\":\"\"},{\"columntype\":\"c\",\"id\":\"_convert\",\"include\":null,\"label\":\"Convert CHAR to VARCHAR:\",\"max\":null,\"min\":null,\"order\":false,\"table\":\"_input\",\"type\":\"columnselector\",\"visible\":\"\"},{\"id\":\"_listing\",\"label\":\"Display CAS table metadata.\",\"type\":\"checkbox\",\"visible\":\"\"},{\"id\":\"_output\",\"label\":\"Output Table:\",\"placeholder\":\"\",\"required\":true,\"type\":\"outputtable\",\"visible\":\"\"}],\"id\":\"page1\",\"label\":\"Options\",\"type\":\"page\"},{\"children\":[{\"id\":\"text2\",\"text\":\"\\nLoad to CAS custom step\\n=====================\\n\\nThis custom step can: \\n    - Load your input table into CAS.\\n    - Append your input table into your CAS table.\\n    - Create the CAS table, in case it doesn't exist.\\n    - Set memory format (for the newly created table).\\n    - Promote your CAS table \\n    - Display table metadata in your log\\n    - Convert CHAR columns into VARCHAR columns.\\n    - Compress the target CAS table.\",\"type\":\"text\",\"visible\":\"\"},{\"children\":[{\"id\":\"text1\",\"text\":\"* Version 1.3 (11FEB2026)\\n    - Added the optional CHAR to VARCHAR conversion and the possibility to compress the CAS table.\\n    - First public release.\\n\\n* Version 1.2\\n    - Bas Altorf added the memory format functionality for the CAS table.\\n    - Internal release\\n\\n* Version 1.1\\n    - Added append functionality.\\n    - Internal release\\n\\n* Version 1.0\\n    - Initial version.\\n    - Internal release\",\"type\":\"text\",\"visible\":\"\"}],\"id\":\"section1\",\"label\":\"Changelog\",\"open\":true,\"type\":\"section\",\"visible\":\"\"}],\"id\":\"page2\",\"label\":\"About\",\"type\":\"page\"}],\"showPageContentOnly\":true,\"syntaxversion\":\"1.3.0\",\"values\":{\"_append\":false,\"_compress\":false,\"_convert\":[],\"_input\":{\"library\":\"\",\"table\":\"\"},\"_listing\":false,\"_memfmt\":{\"label\":\"INHERIT\",\"value\":\"INHERIT\"},\"_output\":{\"library\":\"\",\"table\":\"\"},\"_promote\":true}}","templates":{"SAS":"/*\n    The following macro creates the 'in' clause based on the selected CHAR columns that\n    need to be converted to VARCHAR.\n\n    The result will be something like: (COLUMN_01, COLUMN_02, ..., COLUMN_xx).\n*/\n%macro createINClause;\n    %if &_convert_count > 0 %then %do;\n        %do index = 1 %to &_convert_count;\n            /*\n                For the first column, start with a (\n            */\n            %if &index > 1 %then %do;\n                %let inClause=&inClause., %upcase(\"&&_convert_&index._name\");\n            %end;\n            %else %do;\n                %let inClause=(\"&&_convert_&index._name\";\n            %end;\n        %end;\n        /*\n            End the result with a )\n        */\n        %let inClause=&inClause);\n        %put NOTE: Generated IN clause &inclause;\n    %end;\n    %else %do;\n        %put NOTE: No columns selected to convert.;\n    %end;\n%mend;\n\n%macro createDSStatements\n(\n    srcTable=\n);    \n    /*\n        Extract the library- and table name.\n    */\n    data _null_;\n        call symputx('lib', kstrip(kscan(\"&srcTable\", 1, '.')));\n        call symputx('table', kstrip(kscan(\"&srcTable\", 2, '.')));\n    run;\n    \n    /*\n        Create the IN clause based on the end-user selected columns.\n    */\n    %let inClause=;\n    %createINClause;\n\n    /*\n        The following PROC SQL creates the specified 'statement' variables to be used \n        during the CHAR to VARCHAR conversion.\n\n        A typical conversion script would look like:\n\n        data casuser.source_loaded_varchar(drop=_COLUMN_01 _COLUMN_02 rename=(_COLUMN_01=COLUMN_01 _COLUMN_02=COLUMN_02));\n            set\n                casuser.source_loaded;\n            length\n                _COLUMN_01 varchar(x)\n                _COLUMN_02 varchar(y);\n            \n            _COLUMN_01 = strip(COLUMN_01);\n            _COLUMN_02 = strip(COLUMN_02);\n        run;\n    */\n    proc sql noprint;\n        select\n            /*\n                lengthStatement\n\n                Example: _COLUMN_01 varchar(x) _COLUMN_02 varchar(y)\n                \n            */\n            '_' ||\n            strip(name) || \n            ' varchar(' || \n            strip(put(length, 8.)) || \n            ')',\n            /*\n                copyStatement\n\n                Example: _COLUMN_01 = strip(COLUMN_01); _COLUMN_02 = strip(COLUMN_02);\n            */            \n            '_' ||\n            strip(name) || \n            ' = strip(' ||\n            strip(name) ||\n            ')',\n            /*\n                dropStatement\n\n                Example: _COLUMN_01 _COLUMN_02\n            */\n            strip(name),\n            /*\n                renameStatement\n\n                Example: _COLUMN_01=COLUMN_01 _COLUMN_02=COLUMN_02\n            */\n            '_' ||\n            strip(name) || \n            ' = ' ||\n            strip(name)            \n            into \n                :lengthStatement separated by ' ',\n                :copyStatement separated by '; ',\n                :dropStatement separated by ' ',\n                :renameStatement separated by ' '\n        from\n            dictionary.columns\n        where\n            upcase(libname) = upcase(\"&lib\") and\n            upcase(memname) = upcase(\"&table\") and\n            upcase(type) = \"CHAR\" and\n            /*\n                inClause only contains the columns the end-user selected to be converted.\n            */\n            upcase(name) in &inClause;\n    quit;\n%mend;\n\n%macro load_to_cas;\n    data _null_;\n        call symputx(\"trgtLIB\", kstrip(kscan(\"&_output\", 1, '.')));\n    run;\n    \n \t%let _flw_table_exist = %eval(%sysfunc(exist(&_input, data)) or %sysfunc(exist(&_input, view)));\n    /*\n\t\tOnly continue in case the source table exists.\n\t*/\n\t%if &_flw_table_exist eq 1 %then %do;\n        %let _cas_table_exist = %eval(%sysfunc(exist(&_output, data)));\n\t\t/*\n\t\t\tIf the CAS table does exist and append is chosen, we append.\n\t\t*/\n\t\t%if &_cas_table_exist eq 1 and &_append eq 1 %then %do;\n            %put NOTE: Appending &_input to the table &_output_name;\n\n            %put NOTE: Source table engine: &_input_engine;\n            %if &_input_engine eq V9 %then %do;\n                %if &_convert_count > 0 %then %do;\n                    /*\n                        The source- and target tables differ in data types (CHAR vs. VARCHAR). This will create a problem\n                        when trying to append the source table to the target table directly. To prevent an error\n                        the following steps are to be taken.\n\n                        1. Read the source table, as-is, into the casuser CASlib.\n                    */\n                    proc casutil;\n                        load\n                        data=&_input\n\t\t\t        \toutcaslib=\"casuser\"\n\t\t\t\t        casout=\"source_loaded\"\n    \t\t\t\t    replace;\n                    quit;\n\n                    /*\n                        2. Perform the CHAR to VARCHART conversion for the selected columns.\n                    */\n                    %let lengthStatement=;\n                    %let copyStatement=;\n                    %let dropStatement=;\n                    %let renameStatement=;\n                    %createDSStatements\n                    (\n                        srcTable=casuser.source_loaded\n                    );                    \n                \n                    data casuser.source_loaded_varchar(drop=&dropStatement rename=(&renameStatement));\n              \t\t\tset \n                            casuser.source_loaded;\n                        length \n                            &lengthStatement;\n                        &copyStatement;\n        \t\t    run; \n\n                    /*\n                        3. Append the temporary CAS table with the converted columns to the target CAS table.\n\n                        Note that the source is automatically compresses if the target is compressed.\n                    */\n                    proc casutil;\n\t    \t\t    \tappend\n\t\t    \t\t    srccaslib=casuser\n                        source='source_loaded_varchar'\n\t    \t\t    \ttgtcaslib=\"&trgtLIB\"\n\t\t    \t\t    target=\"&_output_name\"; \n\t\t\t        quit;\n                    /*\n                        4. Drop both temporary tables.\n                    */\n                    proc casutil;\n                        droptable casdata=\"source_loaded\" incaslib=\"casuser\";\n                        droptable casdata=\"source_loaded_varchar\" incaslib=\"casuser\";\n                    quit;\n                %end;\n                %else %do;\n                    proc casutil;\n\t        \t\t\tload\n\t\t        \t\tdata=&_input\n\t\t\t        \toutcaslib=\"&trgtLIB\"\n\t\t\t\t        casout=\"&_output_name\"\n    \t\t\t\t    copies=0\n\t    \t\t\t    append; \n\t\t    \t    quit;\n                %end;\n            %end;\n            %else %do;\n                %if &_convert_count > 0 %then %do;\n                    %put WARNING: Conversion to VARCHAR is canceled because of an incompatible source table engine.; \n                %end;\n                /*\n                    This section is reached because of:\n                    1. The source table exists.\n                    2. The source table engine is not V9.\n                    3. We have might have columns to convert.\n                \n                    Let's try to append the source table as-is, which might fail.\n                */\n                proc casutil;\n\t        \t\tload\n\t\t        \tdata=&_input\n\t\t\t        outcaslib=\"&trgtLIB\"\n\t\t\t\t    casout=\"&_output_name\"\n    \t\t\t\tcopies=0\n\t    \t\t\tappend; \n\t\t    \tquit;                    \n            %end;\n        %end;\n\t\t/*\n\t\t\tIf the CAS table does not exist or we do a replace we can also set the Memory Format\n\t\t*/\n\t\t%else %if &_cas_table_exist eq 0 or &_append eq 0  %then %do;\n\t\t\t/*\n\t\t\t\tNote that: \n                - At this stage is doesn't really matter what the value for _append is.\n                - The table doesn't exist, that makes the if statement true. (Could be removed completely?)\n            \n                The custom step is set to drop and create the CAS table.\n\n                The dropTable action is used to drop tables from memory. If a session-scoped (local)\n\t\t\t\ttable and global-scoped table have identical names, the dropTable action drops the\n\t\t\t\tsession scoped table only when executed. To drop the global-scoped table with the\n\t\t\t\tsame name, you must run the dropTable action a second time after dropping the\n\t\t\t\tsession-scope table.\n\t\t\t*/\n\t\t\t%put NOTE: Dropping the CAS table &_output_name;\n\t\t\tproc cas;\n\t\t\t\ttable.droptable / caslib=\"&trgtLIB\" name=\"&_output_name\" quiet=true;\n\t\t\t\ttable.droptable / caslib=\"&trgtLIB\" name=\"&_output_name\" quiet=true;\n\t\t\tquit;\n\n\t\t\t%put NOTE: Loading the table &_output_name;\n            %if &_convert_count > 0 %then %do;\n                %if &_input_engine eq V9 %then %do;\n                    %put NOTE: Converting CHAR to VARCHAR.;\n                    /*\n                        Initialize the following macro variables.\n                    */\n                    %let lengthStatement=;\n                    %let copyStatement=;\n                    %let dropStatement=;\n                    %let renameStatement=;\n\n                    /*\n                        Generate each datastep part for the CHAR to VARCHAR conversion.\n                    */\n                    %createDSStatements\n                    (\n                        srcTable=&_input\n                    );\n                    /*\n                        Run the conversion while loading the source dataset into memory.\n                    */\n                    %if &_compress eq 1 %then %do;\n                        %put NOTE: Compressing CAS table.;\n                        data &trgtLIB..&_output_name(drop=&dropStatement rename=(&renameStatement) compress=Yes);\n                    %end;\n                    %else %do;\n                        data &trgtLIB..&_output_name(drop=&dropStatement rename=(&renameStatement));\n                    %end;\n\t        \t\t\tset \n                            &_input;\n                        length \n                            &lengthStatement;\n                        &copyStatement;\n    \t\t    \trun;                \n                %end;\n                %else %do;\n                    %put WARNING: Conversion to VARCHAR is canceled because of incompatible source table engine.;\n                    %if &_compress eq 1 %then %do;\n                        %put NOTE: Compressing CAS table.;\n                        data &trgtLIB..&_output_name(compress=Yes);\n                    %end;\n                    %else %do;\n                        data &trgtLIB..&_output_name;\n                    %end;\n\t    \t\t\t    set &_input;\n\t\t    \t    run;\n                %end;\n            %end;    \n            %else %do;\n                %if &_compress eq 1 %then %do;\n                    %put NOTE: Compressing CAS table.;\n                    data &trgtLIB..&_output_name(compress=Yes);\n                %end;\n                %else %do;\n                    data &trgtLIB..&_output_name;\n                %end;\n\t    \t\t\tset &_input;\n\t\t    \trun;\n            %end;\n\t\t\t/*\n\t \t\t\tUse DVR Memory Format to compress the table.\n\t\t\t*/\n            %if &_memfmt ^= INHERIT %then %do; /* INHERIT is the default */\n\t\t\t\t%put NOTE: Setting Memory Format &_memfmt for the table &_output_name;\n\t            proc cas;\n\t\t\t\t\ttable.copyTable / \n\t                  table={\n                        caslib=\"&trgtLIB\", \n                        name=\"&_output_name\"\n                        } \n\t\t\t\t\t  casOut={\n                        caslib=\"&trgtLIB\", \n                        name=\"&_output_name\" , \n                        memoryFormat=\"&_memfmt\", \n                        replace=True, \n                        replication=0, \n                        compress=TRUE\n                        };\n\t\t\t\tquit;\n            %end;\n\t\t%end;\n       \t/*\n\t\t\tThe custom step is set to promote the table, after checking the scope\n\t\t*/\n        %if &_promote eq 1 %then %do;\n\t\t    proc cas;\n\t\t\t\ttable.tableExists result=r / caslib=\"&trgtLIB\", name=\"&_output_name\";\n\t\n\t\t\t\tif r.exists=0 then do;\n\t\t\t\t\tprint \"NOTE: The CAS table &_output_name does not exist.\";\n\t\t\t\tend;\n\t\n\t\t\t\tif r.exists=1 then do;\n\t\t\t\t\tprint \"NOTE: The CAS table &_output_name has a session scope.\";\n\t\t\t\t\tprint \"NOTE: Promoting the CAS table &_output_name..\";\n\t\n\t\t\t\t\t/*\n\t\t\t\t\t    Promote the table.\n\t\t\t\t\t*/\n\t\t\t\t\ttable.promote / caslib=\"&trgtLIB\", name=\"&_output_name\", target=\"&_output_name\", targetlib=\"&trgtLIB\";\n\t\t\t\tend;\n\t\n\t\t\t\tif r.exists=2 then do;\n\t\t\t\t\tprint \"The CAS table &_output_name has a global scope.\";\n\t\t\t\tend;\n\t\t\tquit;\n\t\t%end;\n        /*\n\t\t\tThe custom step is set to generate a CASLib contents in the log.\n\t\t*/\n\t\t%if &_listing eq 1 %then %do;\n\t\t\tproc casutil;\n\t\t\t\tcontents incaslib=\"&trgtLIB\" casdata=\"&_output_name\";\n\t\t\tquit;\n\t\t%end;\n\t%end;\n\t%else %do;\n\t\t%put ER%str()ROR: The source table &_input does not exist. Aborting process;\n\t\t%abort;\n\t%end;\n%mend;\n\n%if &_output_engine eq CAS %then %do;\n    /*\n        The target table is a CAS table, continue the load it.\n    */\n    %load_to_cas;\n%end;\n%else %do;\n    %PUT ERROR: The target table is not a CAS table.;\n%end;\n\n/*\n    Remove all macro variables from memory.\n*/\n%symdel lib /NOWARN;\n%symdel table /NOWARN;\n%symdel lengthStatement /NOWARN;\n%symdel copyStatement /NOWARN;\n%symdel dropStatement /NOWARN;\n%symdel renameStatement /NOWARN;\n%symdel engine /NOWARN;\n%symdel inClause /NOWARN;\n\n/*\n    Remove all macros from memory.\n*/\n%SYSMACDELETE load_to_cas / NOWARN;\n%SYSMACDELETE createDSStatements / NOWARN;\n%SYSMACDELETE createINClause / NOWARN;"}}
