{"creationTimeStamp":"2025-11-20T08:12:12.633385Z","createdBy":"Remco.Gooijer@sas.com","modifiedTimeStamp":"2026-02-04T12:12:19.111414Z","modifiedBy":"Remco.Gooijer@sas.com","id":"8d8de89b-8f64-464c-b0a6-a7da3b892772","name":"Glossary - Get Terms by Term Type(s).step","displayName":"Glossary - Get Terms by Term Type(s).step","localDisplayName":"Glossary - Get Terms by Term Type(s).step","links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772","uri":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772","uri":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772","uri":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772","uri":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772"},{"method":"POST","rel":"copy","href":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772/copy","uri":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772/copy","responseType":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772","uri":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772","uri":"/dataFlows/steps/8d8de89b-8f64-464c-b0a6-a7da3b892772","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":1,"version":2,"type":"code","flowMetadata":{"inputPorts":[{"name":"_input1","displayName":"_input1","localDisplayName":"_input1","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table"}],"outputPorts":[{"name":"_output1","displayName":"_output1","localDisplayName":"_output1","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table"},{"name":"_output2","displayName":"_output2","localDisplayName":"_output2","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table"}]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"page1\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Options\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_input1\",\n\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\"label\": \"Input table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"filter\": false\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_idColumn\",\n\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\"label\": \"Select the column containing the term type id:\",\n\t\t\t\t\t\"include\": null,\n\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\"columntype\": \"c\",\n\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\"min\": 1,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"table\": \"_input1\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_sortBy\",\n\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\"label\": \"Sort by column:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"id\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"name\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"label\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"description\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"createdBy\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"creationTimeStamp\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"modifiedBy\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"modifiedTimeStamp\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"termTypeId\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"parentId\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_limit\",\n\t\t\t\t\t\"type\": \"numberfield\",\n\t\t\t\t\t\"label\": \"Limit the numbers of returned values to:\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"max\": null,\n\t\t\t\t\t\"min\": 10,\n\t\t\t\t\t\"excludemin\": false,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_allowDraft\",\n\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\"label\": \"Allow draft versions:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"user\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"all\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"none\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_output1\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Items output table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_output2\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Attributes output table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"page2\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\\nGlossary - Get Terms by Term Type(s)\\n===============================\\n\\nThis custom step extracts for one or more term types all terms, together with term type attribute values, if available.\\n\\nIt outputs two tables:\\n1. With the terms\\n2. With the term type attribute values for the given terms.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"section1\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Changelog\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"text2\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\":  \"* Version 1.1 (04FEB2026)\\n    - Cleaning libnames and filenames\\n\\n* Version 1.0 (16JAN2026)\\n    - Initial version\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"_input1\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"_idColumn\": [],\n\t\t\"_sortBy\": {\n\t\t\t\"value\": \"name\"\n\t\t},\n\t\t\"_limit\": 50,\n\t\t\"_allowDraft\": {\n\t\t\t\"value\": \"user\"\n\t\t},\n\t\t\"_output1\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"_output2\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t}\n\t},\n\t\"promptHierarchies\": []\n}","localUi":"{\"pages\":[{\"children\":[{\"filter\":false,\"id\":\"_input1\",\"label\":\"Input table:\",\"placeholder\":\"\",\"required\":true,\"type\":\"inputtable\",\"visible\":\"\"},{\"columntype\":\"c\",\"id\":\"_idColumn\",\"include\":null,\"label\":\"Select the column containing the term type id:\",\"max\":1,\"min\":1,\"order\":false,\"table\":\"_input1\",\"type\":\"columnselector\",\"visible\":\"\"},{\"id\":\"_sortBy\",\"items\":[{\"value\":\"id\"},{\"value\":\"name\"},{\"value\":\"label\"},{\"value\":\"description\"},{\"value\":\"createdBy\"},{\"value\":\"creationTimeStamp\"},{\"value\":\"modifiedBy\"},{\"value\":\"modifiedTimeStamp\"},{\"value\":\"termTypeId\"},{\"value\":\"parentId\"}],\"label\":\"Sort by column:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"excludemin\":false,\"id\":\"_limit\",\"label\":\"Limit the numbers of returned values to:\",\"max\":null,\"min\":10,\"placeholder\":\"\",\"required\":true,\"type\":\"numberfield\",\"visible\":\"\"},{\"id\":\"_allowDraft\",\"items\":[{\"value\":\"user\"},{\"value\":\"all\"},{\"value\":\"none\"}],\"label\":\"Allow draft versions:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"id\":\"_output1\",\"label\":\"Items output table:\",\"placeholder\":\"\",\"required\":true,\"type\":\"outputtable\",\"visible\":\"\"},{\"id\":\"_output2\",\"label\":\"Attributes output table:\",\"placeholder\":\"\",\"required\":true,\"type\":\"outputtable\",\"visible\":\"\"}],\"id\":\"page1\",\"label\":\"Options\",\"type\":\"page\"},{\"children\":[{\"id\":\"text1\",\"text\":\"\\nGlossary - Get Terms by Term Type(s)\\n===============================\\n\\nThis custom step extracts for one or more term types all terms, together with term type attribute values, if available.\\n\\nIt outputs two tables:\\n1. With the terms\\n2. With the term type attribute values for the given terms.\",\"type\":\"text\",\"visible\":\"\"},{\"children\":[{\"id\":\"text2\",\"text\":\"* Version 1 (12JAN2026)\\n    - Initial version\",\"type\":\"text\",\"visible\":\"\"}],\"id\":\"section1\",\"label\":\"Changelog\",\"open\":true,\"type\":\"section\",\"visible\":\"\"}],\"id\":\"page2\",\"label\":\"About\",\"type\":\"page\"}],\"promptHierarchies\":[],\"showPageContentOnly\":true,\"syntaxversion\":\"1.3.0\",\"values\":{\"_allowDraft\":{\"value\":\"user\"},\"_idColumn\":[],\"_input1\":{\"library\":\"\",\"table\":\"\"},\"_limit\":50,\"_output1\":{\"library\":\"\",\"table\":\"\"},\"_output2\":{\"library\":\"\",\"table\":\"\"},\"_sortBy\":{\"value\":\"name\"}}}","templates":{"SAS":"/*\r\n    SAS Documentation: https://developer.sas.com/rest-apis/glossary\r\n\r\n    Initialize the following two macro variables.\r\n*/\r\ndata _null_; \r\n\tcall symputx('viyaHost', reverse(substr(substr(reverse(\"&_BASEURL.\"), 2), find(substr(reverse(\"&_BASEURL.\"), 2), '/') + 1)));\r\nrun;\r\n%let inError=0;\r\n\r\n/*\r\n    The basis for the _output1 table.\r\n    Note that columns need to be renamed and converted from character to timestamp for the final output table.\r\n*/\r\ndata terms;\r\n    attrib Id length=$36.;\r\n    attrib termTypeId length=$36.;\r\n    attrib termTypeLabel length=$512.;\r\n    attrib version length=8.;\r\n    attrib name length=$512.;\r\n    attrib description length=$8192.;\r\n    attrib definition length=$1024.;\r\n    attrib parentId length=$36.;\r\n    attrib assetCount length=8.;\r\n    attrib isDraft length=8.;\r\n    attrib status length=$16.;\r\n    attrib createdBy length=$64.;\r\n    attrib creationTimeStamp length=$24.;\r\n    attrib modifiedBy length=$64.;\r\n    attrib modifiedTimeStamp length=$24.;\r\n    stop;\r\nrun;\r\n\r\ndata &_output2;\r\n    attrib termId length=$36.;\r\n    attrib attributeId length=$36.;\r\n    attrib attributeValue length=$1024.;\r\n    stop;\r\nrun;\r\n\r\n/*\r\n    Not all columns are available for each term type.\r\n    The following macro gives me the columns that ARE available.\r\n*/\r\n%macro existingColumns\r\n(\r\n    tableName=\r\n);    \r\n    proc sql noprint;\r\n        select\r\n            name into :existing_columns separated by ', '\r\n        from\r\n            dictionary.columns\r\n        where\r\n            upcase(libname) = 'TERMS' and\r\n            upcase(memname) = \"&tableName\" and\r\n            upcase(name) not like '%ORDINAL_%';\r\n    quit;\r\n%mend;\r\n\r\n%macro getTermsByTermType\r\n(\r\n    termTypeId=\r\n);\r\n    filename terms temp;\r\n    /*\r\n        The following API call extracts terms for the specified termTypeId and for the given\r\n        'draft' filtering.\r\n    */\r\n    proc http\r\n        method ='get'\r\n        url = \"&viyaHost./glossary/terms?filter=eq(termTypeId, '&termTypeId')%nrstr(&)allowDrafts=&_allowDraft%nrstr(&)limit=&_limit\"\r\n        oauth_bearer = sas_services\r\n        out = terms;\r\n        headers\r\n            \"Accept\"=\"application/json, application/vnd.sas.collection+json, application/vnd.sas.error+json\"\r\n            \"Accept-Item\"=\"application/vnd.sas.glossary.term+json\";\r\n    run;\r\n\r\n    /*\r\n        Only add the terms if we've received feedback.\r\n    */\r\n    %if %sysfunc(fexist(terms)) %then %do;\r\n        libname terms json;\r\n\r\n        %let existing_columns =;\r\n        %existingColumns(tableName=ITEMS);\r\n\r\n        %if &existing_columns ne %then %do;\r\n            proc sql noprint;\r\n                insert into terms\r\n                (\r\n                    &existing_columns\r\n                )\r\n                select\r\n                    &existing_columns\r\n                from\r\n                    terms.items;\r\n            quit;\r\n        %end;\r\n    %end;\r\n    %else %do;\r\n        %put ERROR: No response file received for macro 'getTermsByTermType'. Please review the log for more details.;\r\n        %let inError = 1;\r\n    %end;\r\n%mend;\r\n\r\n%macro getTermsByTermTypeId;\r\n    /*\r\n        Load each termTypeId into memory\r\n    */\r\n    %let nbr_ids=0;\r\n    data _null_;\r\n        set \r\n            &_input1(keep=&_idColumn) end=last;\r\n        call symputx(\"&&_idColumn\"||kstrip(put(_N_, 8.)), strip(&_idColumn));\r\n        if last then call symputx('nbr_ids', _n_);\r\n    run;\r\n\r\n    /*\r\n        And run for each termTypeId the specified macro.\r\n    */\r\n    %do index = 1 %to &nbr_ids;\r\n        %put NOTE: Processing termTypeId (&index of &nbr_ids): &&&_idColumn&index;\r\n        %getTermsByTermType\r\n            (\r\n                termTypeId = &&&_idColumn&index\r\n            );\r\n    %end;\r\n%mend;\r\n\r\n%if &inError eq 0 %then %do;\r\n    %getTermsByTermTypeId;\r\n%end;\r\n\r\n%macro getTermsByTermId\r\n(\r\n    termId=\r\n);\r\n    filename terms temp;\r\n    proc http\r\n        method ='get'\r\n        url = \"&viyaHost./glossary/terms/&termId?allowDraft=&_allowDraft%nrstr(&)limit=&_limit\"\r\n        oauth_bearer = sas_services\r\n        out = terms;\r\n        headers\r\n            \"Accept\"=\"application/vnd.sas.glossary.term+json, application/vnd.sas.error+json\";\r\n    run;\r\n\r\n    /*\r\n        The attributes section of the json response file can't be processed\r\n        using the json libname engine. So we do it the old fashioned way.\r\n\r\n        Assmumptions here are:\r\n        - The size of the response file has a maximum of 32 Kb.\r\n        - The response file contains a json string on 1 line.\r\n    */\r\n    %if %sysfunc(fexist(terms)) %then %do;\r\n        data termAttributes\r\n            (\r\n                keep=\r\n                    termId\r\n                    attributeId\r\n                    attributeValue\r\n            );\r\n            infile \r\n                terms \r\n                lrecl=32767\r\n                truncover;\r\n\r\n            attrib json length=$32767.;\r\n            attrib attrs length=$32767.;\r\n            attrib pair length=$1024.;\r\n            attrib termId length=$36.;\r\n            attrib attributeId length=$36.;\r\n            attrib attributeValue length=$1024.;\r\n\r\n            input json $char32767.;\r\n            \r\n            /*\r\n                Only continue processing in case we have attributes to process.            \r\n            */\r\n            if kindex(json,'\"attributes\"') = 0 then stop;\r\n\r\n            /* \r\n                Extract content inside attributes:{ ... } \r\n            */\r\n            attrs = prxchange('s/.*\"attributes\":\\{//', 1, json);\r\n            attrs = prxchange('s/}.*$//', 1, attrs);\r\n            termId = \"&termId\";\r\n\r\n            /*\r\n                Only continue in case there are attributes to process.\r\n            */\r\n            if missing(attrs) then stop;\r\n\r\n            /* \r\n                Regex to split on commas OUTSIDE quotes \r\n            */\r\n            retain rxSplit;\r\n            if _n_ = 1 then\r\n                rxSplit = prxparse('/,(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/');\r\n\r\n            pos = 1;\r\n            start = 1;\r\n\r\n            /* \r\n                Loop through comma-separated key:value pairs \r\n            */\r\n            do while (prxmatch(rxSplit, ksubstr(attrs, pos)));\r\n                offset = prxmatch(rxSplit, ksubstr(attrs, pos));\r\n                len = offset - 1;\r\n\r\n                pair = ksubstr(attrs, start, len);\r\n                call missing(attributeId, attributeValue);\r\n\r\n                pair = kcompress(kstrip(pair), '\"');\r\n\r\n                attributeId = kstrip(kscan(pair, 1, ':'));\r\n                attributeValue = kstrip(ksubstr(pair, klength(attributeId) + 2));\r\n\r\n                pos + offset;\r\n                start + offset;\r\n        \r\n                if not missing(attributeId) then output;\r\n            end;\r\n\r\n            /*\r\n                Process the last one.\r\n            */\r\n            pair  = compress(kstrip(ksubstr(attrs, start)), '\"');\r\n            attributeId = kstrip(kscan(pair, 1, ':'));\r\n            attributeValue = kstrip(ksubstr(pair, klength(attributeId) + 2));\r\n\r\n            if not missing(attributeId) then output;\r\n        run;\r\n\r\n        /*\r\n            Add the current batch of attributes to the second output table.\r\n        */\r\n        proc sql noprint;\r\n            insert into &_output2 select * from termAttributes;\r\n        quit;\r\n    %end;\r\n    %else %do;\r\n        %put ERROR: No response file received for macro 'getTermsByTermId'. Please review the log for more details.;\r\n        %let inError = 1;\r\n    %end;\r\n%mend;\r\n\r\n%macro getTermAttrValues;\r\n    /*\r\n        Load each termId into memory\r\n    */\r\n    %let nbr_ids=0;\r\n    data _null_;\r\n        set \r\n            &_output1\r\n                (\r\n                    keep=termId\r\n                ) end=last;\r\n        call symputx(\"termId\"||kstrip(put(_N_, 8.)), strip(termId));\r\n        if last then call symputx('nbr_ids', _n_);\r\n    run;\r\n\r\n    /*\r\n        And run for each termTypeId the specified macro.\r\n    */\r\n    %do index = 1 %to &nbr_ids;\r\n        %put NOTE: Processing termId (&index of &nbr_ids): &&termId&index;\r\n        %getTermsByTermId\r\n            (\r\n                termId = &&termId&index\r\n            );\r\n    %end;\r\n%mend;\r\n\r\n/*\r\n    Sort the resulting table according to the end-user's requirments.\r\n*/\r\nproc sort data=terms;\r\n    by \r\n        &_sortBy;\r\nrun;\r\n\r\n/*\r\n    Create the first output table based on:\r\n\r\n    1. The terms table.\r\n    2. a renamed id column.\r\n    3. converted creation- and modifiedTimeStamp\r\n*/\r\n\r\ndata &_output1\r\n    (\r\n        drop=\r\n            _creationTimeStamp \r\n            _modifiedTimeStamp \r\n            termTypeLabel\r\n        rename=\r\n            (id = termId)\r\n    );\r\n    attrib creationTimeStamp length=8. format=datetime22.3;\r\n    attrib modifiedTimeStamp length=8. format=datetime22.3;\r\n\r\n    set\r\n        terms\r\n            (\r\n                rename=\r\n                    (\r\n                        creationTimeStamp=_creationTimeStamp \r\n                        modifiedTimeStamp=_modifiedTimeStamp\r\n                    )\r\n            );\r\n    /*\r\n        Convert the source columns to be of type datetime22.3\r\n    */\r\n    creationTimeStamp = input(_creationTimeStamp, E8601DZ.);\r\n    modifiedTimeStamp = input(_modifiedTimeStamp, E8601DZ.);\r\nrun;\r\n\r\n/*\r\n    The following macro depends on the _output1 table to be done and ready.\r\n*/\r\n%if &inError eq 0 %then %do;\r\n    %getTermAttrValues;\r\n%end;\r\n\r\n/*\r\n    Clear libname-, filename references and work tables.\r\n*/\r\n%macro clearTable\r\n(\r\n    tableName=\r\n);\r\n    proc datasets library=WORK memtype=(data view) nolist nowarn;\r\n        delete &tableName;\r\n    quit;\r\n%mend;\r\n\r\nlibname terms clear;\r\nfilename terms clear;\r\n%clearTable(tableName=terms);\r\n%clearTable(tableName=termAttributes);\r\n\r\n/*\r\n    Remove all macro variables from memory.\r\n*/\r\n%symdel inError /NOWARN;\r\n%symdel nbr_ids /NOWARN;\r\n%symdel existing_columns /NOWARN;\r\n%symdel viyaHost /NOWARN;\r\n\r\n/*\r\n    Remove all macros from memory.\r\n*/\r\n%SYSMACDELETE clearTable / NOWARN;\r\n%SYSMACDELETE getTermAttrValues / NOWARN;\r\n%SYSMACDELETE getTermsByTermId / NOWARN;\r\n%SYSMACDELETE existingColumns / NOWARN;\r\n%SYSMACDELETE getTermsByTermTypeId / NOWARN;"}}
