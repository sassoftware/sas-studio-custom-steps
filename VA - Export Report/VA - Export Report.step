{"creationTimeStamp":"2025-10-16T08:24:45.357866Z","createdBy":"Remco.Gooijer@sas.com","modifiedTimeStamp":"2025-11-18T14:17:58.321959Z","modifiedBy":"Remco.Gooijer@sas.com","name":"VA - Export Report.step","displayName":"VA - Export Report.step","localDisplayName":"VA - Export Report.step","links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6","uri":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6","uri":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6","uri":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6","uri":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6"},{"method":"POST","rel":"copy","href":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6/copy","uri":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6/copy","responseType":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6","uri":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6","uri":"/dataFlows/steps/4787ec36-52e2-47e1-8b53-276a4b7b85c6","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":1,"version":2,"type":"code","flowMetadata":{},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"page1\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Options\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_report\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"Select the report for which you want to create an export:\",\n\t\t\t\t\t\"pathtype\": \"file\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_packageDir\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"Select the SAS Server directory where the export will be created:\",\n\t\t\t\t\t\"pathtype\": \"folder\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_exportType\",\n\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\"label\": \"Export as:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"Package\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"PDF\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"PNG\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"SVG\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"section2\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"PDF options\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$_exportType\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"PDF\"\n\t\t\t\t\t],\n\t\t\t\t\t\"indent\": 0,\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_coverPageText\",\n\t\t\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\t\t\"label\": \"Cover page text:\",\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_expandClippedContent\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Expand clipped content:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"true\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"false\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_includeAppendix\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Include appendix:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"true\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"false\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_includeComments\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Include comments:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"true\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"false\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_includeCoverPage\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Include cover page:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"true\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"false\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_includeDetailsTables\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Include details tables:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"true\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"false\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_includeTableOfContents\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Include table of contents:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"true\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"false\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_orientation\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Orientation:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"landscape\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"portrait\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_paperSize\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Paper size:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"letter\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"legal\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"A3\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"A4\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"A5\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"B4\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"B5\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"ledger\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_showEmptyRowsAndColumns\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Show empty rows and columns:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"true\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"false\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_showPageNumbers\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Show page numbers:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"true\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"false\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"section3\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"PNG  and SVG option\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$_exportType\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"PNG\"\n\t\t\t\t\t\t],\n\t\t\t\t\t\t\"|\",\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\"$_exportType\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\t\"SVG\"\n\t\t\t\t\t\t]\n\t\t\t\t\t],\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_size\",\n\t\t\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\t\t\"label\": \"Image size:\",\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_addition\",\n\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\"label\": \"Add the following to the export name:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"<Nothing>\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"Date\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"Timestamp\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"page2\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"\\nVA - Export Report step\\n====================\\n\\nThis custom step exports a Visual Analytics report as a package for the selected report in a compressed (zip) format. The returned content contains the report source files, plus the results of data queries and image rendering, constituting all that is needed for remote viewing of the report or you can export the report as a PDF, SVG or PNG.\\n\\nThe step needs the location and name of the report and a physical location where the export will be stored.\\n\\nThe name of the export will always be the same as the report name with the optional addition of a date, format YYYYMMDD, or timestamp, format YYYYMMDD_HHMMSS.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"section1\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Changelog\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"text2\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"* Version 2.0 (21NOV2025)\\n- The ability to export a report as a PDF, SVG or PNG has been added.\\n\\n* Version 1.1 (04NOV2025)\\n- Rename step and update wordings.\\n\\n* Version 1.0 (16OCT2025)\\n- Initial version\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"_report\": \"\",\n\t\t\"_packageDir\": \"\",\n\t\t\"_exportType\": {\n\t\t\t\"value\": \"Package\"\n\t\t},\n\t\t\"_coverPageText\": \"\",\n\t\t\"_expandClippedContent\": {\n\t\t\t\"value\": \"false\"\n\t\t},\n\t\t\"_includeAppendix\": {\n\t\t\t\"value\": \"true\"\n\t\t},\n\t\t\"_includeComments\": {\n\t\t\t\"value\": \"false\"\n\t\t},\n\t\t\"_includeCoverPage\": {\n\t\t\t\"value\": \"true\"\n\t\t},\n\t\t\"_includeDetailsTables\": {\n\t\t\t\"value\": \"false\"\n\t\t},\n\t\t\"_includeTableOfContents\": {\n\t\t\t\"value\": \"false\"\n\t\t},\n\t\t\"_orientation\": {\n\t\t\t\"value\": \"landscape\"\n\t\t},\n\t\t\"_paperSize\": {\n\t\t\t\"value\": \"letter\"\n\t\t},\n\t\t\"_showEmptyRowsAndColumns\": {\n\t\t\t\"value\": \"false\"\n\t\t},\n\t\t\"_showPageNumbers\": {\n\t\t\t\"value\": \"true\"\n\t\t},\n\t\t\"_size\": \"1024px,768px\",\n\t\t\"_addition\": {\n\t\t\t\"value\": \"<Nothing>\"\n\t\t}\n\t},\n\t\"promptHierarchies\": []\n}","localUi":"{\"pages\":[{\"children\":[{\"id\":\"_report\",\"label\":\"Select the report for which you want to create an export:\",\"pathtype\":\"file\",\"placeholder\":\"\",\"required\":true,\"type\":\"path\",\"visible\":\"\"},{\"id\":\"_packageDir\",\"label\":\"Select the SAS Server directory where the export will be created:\",\"pathtype\":\"folder\",\"placeholder\":\"\",\"required\":true,\"type\":\"path\",\"visible\":\"\"},{\"id\":\"_exportType\",\"items\":[{\"value\":\"Package\"},{\"value\":\"PDF\"},{\"value\":\"PNG\"},{\"value\":\"SVG\"}],\"label\":\"Export as:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"children\":[{\"id\":\"_coverPageText\",\"label\":\"Cover page text:\",\"placeholder\":\"\",\"required\":false,\"type\":\"textfield\",\"visible\":\"\"},{\"id\":\"_expandClippedContent\",\"items\":[{\"value\":\"true\"},{\"value\":\"false\"}],\"label\":\"Expand clipped content:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"id\":\"_includeAppendix\",\"items\":[{\"value\":\"true\"},{\"value\":\"false\"}],\"label\":\"Include appendix:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"id\":\"_includeComments\",\"items\":[{\"value\":\"true\"},{\"value\":\"false\"}],\"label\":\"Include comments:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"id\":\"_includeCoverPage\",\"items\":[{\"value\":\"true\"},{\"value\":\"false\"}],\"label\":\"Include cover page:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"id\":\"_includeDetailsTables\",\"items\":[{\"value\":\"true\"},{\"value\":\"false\"}],\"label\":\"Include details tables:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"id\":\"_includeTableOfContents\",\"items\":[{\"value\":\"true\"},{\"value\":\"false\"}],\"label\":\"Include table of contents:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"id\":\"_orientation\",\"items\":[{\"value\":\"landscape\"},{\"value\":\"portrait\"}],\"label\":\"Orientation:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"id\":\"_paperSize\",\"items\":[{\"value\":\"letter\"},{\"value\":\"legal\"},{\"value\":\"A3\"},{\"value\":\"A4\"},{\"value\":\"A5\"},{\"value\":\"B4\"},{\"value\":\"B5\"},{\"value\":\"ledger\"}],\"label\":\"Paper size:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"id\":\"_showEmptyRowsAndColumns\",\"items\":[{\"value\":\"true\"},{\"value\":\"false\"}],\"label\":\"Show empty rows and columns:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"},{\"id\":\"_showPageNumbers\",\"items\":[{\"value\":\"true\"},{\"value\":\"false\"}],\"label\":\"Show page numbers:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"}],\"id\":\"section2\",\"indent\":0,\"label\":\"PDF options\",\"open\":true,\"type\":\"section\",\"visible\":[\"$_exportType\",\"=\",\"PDF\"]},{\"children\":[{\"id\":\"_size\",\"label\":\"Image size:\",\"placeholder\":\"\",\"required\":true,\"type\":\"textfield\",\"visible\":\"\"}],\"id\":\"section3\",\"label\":\"PNG  and SVG option\",\"open\":true,\"type\":\"section\",\"visible\":[[\"$_exportType\",\"=\",\"PNG\"],\"|\",[\"$_exportType\",\"=\",\"SVG\"]]},{\"id\":\"_addition\",\"items\":[{\"value\":\"\\u003cNothing\\u003e\"},{\"value\":\"Date\"},{\"value\":\"Timestamp\"}],\"label\":\"Add the following to the export name:\",\"placeholder\":\"\",\"required\":true,\"type\":\"dropdown\",\"visible\":\"\"}],\"id\":\"page1\",\"label\":\"Options\",\"type\":\"page\"},{\"children\":[{\"id\":\"text1\",\"text\":\"\\nVA - Export Report step\\n====================\\n\\nThis custom step exports a Visual Analytics report as a package for the selected report in a compressed (zip) format. The returned content contains the report source files, plus the results of data queries and image rendering, constituting all that is needed for remote viewing of the report or you can export the report as a PDF, SVG or PNG.\\n\\nThe step needs the location and name of the report and a physical location where the export will be stored.\\n\\nThe name of the export will always be the same as the report name with the optional addition of a date, format YYYYMMDD, or timestamp, format YYYYMMDD_HHMMSS.\",\"type\":\"text\",\"visible\":\"\"},{\"children\":[{\"id\":\"text2\",\"text\":\"* Version 2.0 (21NOV2025)\\n- The ability to export a report as a PDF, SVG or PNG has been added.\\n\\n* Version 1.1 (04NOV2025)\\n- Rename step and update wordings.\\n\\n* Version 1.0 (16OCT2025)\\n- Initial version\",\"type\":\"text\",\"visible\":\"\"}],\"id\":\"section1\",\"label\":\"Changelog\",\"open\":true,\"type\":\"section\",\"visible\":\"\"}],\"id\":\"page2\",\"label\":\"About\",\"type\":\"page\"}],\"promptHierarchies\":[],\"showPageContentOnly\":true,\"syntaxversion\":\"1.3.0\",\"values\":{\"_addition\":{\"value\":\"\\u003cNothing\\u003e\"},\"_coverPageText\":\"\",\"_expandClippedContent\":{\"value\":\"false\"},\"_exportType\":{\"value\":\"Package\"},\"_includeAppendix\":{\"value\":\"true\"},\"_includeComments\":{\"value\":\"false\"},\"_includeCoverPage\":{\"value\":\"true\"},\"_includeDetailsTables\":{\"value\":\"false\"},\"_includeTableOfContents\":{\"value\":\"false\"},\"_orientation\":{\"value\":\"landscape\"},\"_packageDir\":\"\",\"_paperSize\":{\"value\":\"letter\"},\"_report\":\"\",\"_showEmptyRowsAndColumns\":{\"value\":\"false\"},\"_showPageNumbers\":{\"value\":\"true\"},\"_size\":\"1024px,768px\"}}","templates":{"SAS":"/*\r\n    The base URL for your SAS Viya installation.\r\n*/\r\n%let base_uri=%sysfunc(getoption(SERVICESBASEURL));\r\n\r\n/*\r\n    The following variables can be used to, optionally, add to your export file name.\t\r\n*/\r\n%let timestamp = %sysfunc(compress(%sysfunc(time(), time8.), ':'));\r\n%let datestamp = %sysfunc(date(), YYMMDDN8.);\r\n%let dttmstamp = &datestamp._&timestamp;\r\n\r\n/*\r\n    From the _report and _packageDir macro variables create separate values for the following macro variables:\r\n*/\r\ndata _null_;\r\n    call symputx('reportName', kreverse(kscan(kreverse(kscan(\"&_report\", 2, ':')), 1, '/')));\r\n    call symputx(\"path\", kreverse(ksubstr(kreverse(kscan(\"&_report\", 2, ':')), kfind(kreverse(kscan(\"&_report\", 2, ':')), '/'))));\r\n    call symputx(\"packageDir\", kscan(\"&_packageDir\", 2, ':'));\r\n    call symputx(\"dirType\", kstrip(kscan(\"&_packageDir\", 1, ':')));\r\nrun;\r\n\r\n/*\r\n    This version will only work when the export is stored on a physical file system.\r\n*/\r\n%if &dirType eq sasserver %then %do;\r\n\r\n    /*\r\n        Based on the 'path' macro variable retrieve the endpoint to give me the folder members/content.\r\n    */\r\n    filename ref temp;\r\n    proc http\r\n        url = \"&base_uri./folders/folders/@item\"\r\n            query = (\"path\" = \"&path\")\r\n            oauth_bearer = sas_services\r\n        out= ref;\r\n        headers\r\n            'Accept'= 'application/vnd.sas.content.folder+json';\r\n    run;\r\n    libname ref json;\r\n\r\n    /*\r\n        From the links table, store the member end-point and the content type into macro variables.\r\n    */\r\n    proc sql noprint;\r\n        select \r\n            href, \r\n            type into :endpoint, :type\r\n        from \r\n            ref.links\r\n        where \r\n            method = \"GET\" and \r\n            rel = \"members\";\r\n    quit; \r\n\r\n    /*\r\n        Retrieve the members/content within the directory\r\n\r\n        Note the limit addition, which needs to be large enough to contain the requested report.\r\n    */\r\n    filename members temp; \r\n    proc http\r\n        url = \"&base_uri.%trim(&endpoint)?limit=150\"\r\n            oauth_bearer = sas_services\r\n        out = members;\r\n        headers\r\n            \"Accept\"= \"%trim(&type)+json\";\r\n    run; \r\n    libname members json;\r\n\r\n    /*\r\n        Get the reportId for the specified report.\r\n    */\r\n    proc sql noprint;\r\n        select\r\n            kstrip(kreverse(kscan(kreverse(uri), 1, '/'))) as reportId length=64 into :reportId TRIMMED\r\n        from\r\n            members.items\r\n        where\r\n            name = \"&reportName\";\r\n    quit;\r\n\r\n    /*\r\n        End user feedback.\r\n    */\r\n    %macro request_status;\r\n        %if &SYS_PROCHTTP_STATUS_CODE eq 200 %then %do;\r\n            %put NOTE: Report export for \"&reportName\" successfully created.;\r\n        %end;\r\n        %else %do;\r\n            %put ERROR: Report export creation for \"&reportName\" failed.;\r\n            %put &=SYS_PROCHTTP_STATUS_CODE;\r\n            %put &=SYS_PROCHTTP_STATUS_PHRASE;\r\n        %end;\r\n    %mend;\r\n\r\n    /*\r\n        The macro responsible for creating the export file.\r\n    */\r\n    %macro create_export;\r\n        /*\r\n            Create the resulting file name, without the extension. The extension will be\r\n            added based on the exportType (zip, pdf, png or svg.)\r\n        */\r\n        %let export_file =;\r\n        %if &_addition eq Date %then %do;\r\n            %let export_file = &packageDir/&reportName._&datestamp;\r\n        %end;\r\n        %else %do;\r\n            %if &_addition eq Timestamp %then %do;\r\n                %let export_file = &packageDir/&reportName._&dttmstamp;\r\n            %end;\r\n            %else %do;\r\n                %let export_file = &packageDir/&reportName;\r\n            %end;\r\n        %end;\r\n\r\n        %if &_exportType eq Package %then %do;\r\n            /*\r\n                Ask Viya to create the export package for the requested report.\r\n\r\n                API documentation: https://developer.sas.com/rest-apis/visualAnalytics/getExportedReportPackage\r\n            */\r\n            filename resp \"&export_file..zip\";\r\n            proc http\r\n                method='get'\r\n                url = \"&base_uri./visualAnalytics/reports/&reportId./package\"\r\n                oauth_bearer = sas_services\r\n                out=resp;\r\n                headers\r\n                    'Accept'='application/zip, application/json, application/vnd.sas.error+json, aplication/json';\r\n            run;\r\n        %end;\r\n        %else %do;\r\n            %if &_exportType eq PDF %then %do;\r\n                /*\r\n                    Check the length of the coverPageText (cpt) variable. There's room for (2048 - 262 =) 1786 characters.\r\n                    Note that the default length of the 'query' variable is 262 characters.\r\n                */\r\n                %let cptLength = %sysfunc(length(\"&_coverPageText\"));\r\n\r\n                %if &cptLength LE 1786 %then %do;\r\n\r\n                    /*\r\n                        Ask Viya to create a PDF for the requested report.\r\n\r\n                        API documentation: https://developer.sas.com/rest-apis/visualAnalytics/getExportedReportPdf\r\n                    */\r\n                    %let query=;\r\n                    data _null_;\r\n                        attrib query length=$2048.;\r\n                        query = cat\r\n                        (\r\n                            '(',\r\n                            '\"coverPageText\"=\"', strip(\"&_coverPageText\"), '\"',\r\n                            ' \"includeCoverPage\"=', \"&_includeCoverPage\",\r\n                            ' \"paperSize\"=\"', strip(\"&_paperSize\"), '\"',\r\n                            ' \"showPageNumbers\"=', \"&_showPageNumbers\",\r\n                            ' \"orientation\"=\"', strip(\"&_orientation\"), '\"',\r\n                            ' \"expandClippedContent\"=', \"&_expandClippedContent\",\r\n                            ' \"includeAppendix\"=', \"&_includeAppendix\",\r\n                            ' \"includeDetailsTables\"=', \"&_includeDetailsTables\",\r\n                            ' \"includeTableOfContents\"=', \"&_includeTableOfContents\",\r\n                            ' \"showEmptyRowsAndColumns\"=', \"&_showEmptyRowsAndColumns\",\r\n                            ')'\r\n                        );\r\n    \r\n                        call symputx\r\n                        (\r\n                            \"query\", strip(query)\r\n                        );\r\n                    run;\r\n\r\n                    filename resp \"&export_file..pdf\";\r\n                    proc http\r\n                        method ='get'\r\n                        url = \"&base_uri./visualAnalytics/reports/&reportId./pdf\"\r\n                        oauth_bearer = sas_services\r\n                        out = resp\r\n                        query = &query;\r\n                        headers\r\n                            \"Accept\" = \"application/pdf\"\r\n                            \"Accept-Language\" = \"*\"\r\n                            \"Accept-Locale\" = \"en-US\";\r\n                    run;\r\n                %end;\r\n                %else %do;\r\n                    %put ERROR: The cover page text is too long. (&cptLength characters.);\r\n                %end;\r\n            %end;\r\n            %else %do;\r\n                /*\r\n                    Make sure that the image size value is following the required pattern.\r\n                    Note that the required pattern is taken from: https://developer.sas.com/rest-apis/visualAnalytics/getExportedReportImagePNG\r\n\r\n                    Made sure that is also accepts spaces between the length- and hight specification.\r\n                */\r\n                %let sizeIsValid=0;\r\n                data _null_;\r\n                    if prxmatch(\"/[0-9]{2,6}px\\s*,\\s*[0-9]{2,6}px/\", \"&_size\") > 0 then do;\r\n                        call symputx(\"sizeIsValid\", 1);\r\n                    end;\r\n                run;\r\n\r\n                %if (&sizeIsValid) %then %do;\r\n                    /*\r\n                        The image size pattern for the image is valid.\r\n\r\n                        The following section is responsible for the svg & png export.\r\n\r\n                        API documentation:\r\n                            https://developer.sas.com/rest-apis/visualAnalytics/getExportedReportImageSVG\r\n                            https://developer.sas.com/rest-apis/visualAnalytics/getExportedReportImagePNG\r\n                    */\r\n                    %let query=;\r\n                    data _null_;\r\n                        attrib query length=$2048.;\r\n                        query = cat\r\n                        (\r\n                            '(',\r\n                            '\"size\"=\"', strip(\"&_size\"), '\"',\r\n                            ')'\r\n                        );\r\n                        \r\n                        call symputx\r\n                        (\r\n                            \"query\", strip(query)\r\n                        );\r\n                    run;\r\n                    \r\n                    /*\r\n                        At this stage _exportType contains svg or png.\r\n                    */\r\n                    %let _exportType = %sysfunc(lowcase(&_exportType));\r\n\r\n                    filename resp \"&export_file..&_exportType\";\r\n\r\n                    /*\r\n                        Do the actual request.\r\n                    */\r\n                    proc http\r\n                        method ='get'\r\n                        url = \"&base_uri./visualAnalytics/reports/&reportId./&_exportType\"\r\n                        oauth_bearer = sas_services\r\n                        out = resp\r\n                        query = &query;\r\n                        headers\r\n                        %if &_exportType EQ png %then %do;\r\n                            'Accept'='image/png, application/json, application/vnd.sas.error+json, aplication/json';\r\n                        %end;\r\n                        %else %do;\r\n                            'Accept'='image/svg+xml, application/json, application/vnd.sas.error+json, aplication/json';\r\n                        %end;\r\n                    run;\r\n                %end;\r\n                %else %do;\r\n                    %put ERROR: Please enter a valid image size! (Expected pattern: 9999px,9999px Received value: &_size);\r\n                %end;\r\n            %end;\r\n        %end;\r\n\r\n        /*\r\n            Validate the return codes for the last HTTP(S) call and give feedback to the end-user in the LOG.\r\n        */\r\n        %request_status;\r\n    %mend;\r\n    \r\n    /*\r\n        Call the create_export macro and generated the requested export.\r\n    */\r\n    %create_export;\r\n%end;\r\n%else %do;\r\n    %put ERROR: Please select a location on the SAS Server. SAS Content folders are not supported by this custom step;\r\n%end;\r\n\r\n/*\r\n    Remove all macro variables from memory.\r\n*/\r\n%symdel base_uri /NOWARN;\r\n%symdel timestamp /NOWARN;\r\n%symdel datestamp /NOWARN;\r\n%symdel dttmstamp /NOWARN;\r\n%symdel reportName /NOWARN;\r\n%symdel path /NOWARN;\r\n%symdel packageDir /NOWARN;\r\n%symdel reportId /NOWARN;\r\n%symdel dirType /NOWARN;\r\n%symdel cptLength /NOWARN;\r\n%symdel query /NOWARN;\r\n%symdel export_file /NOWARN;\r\n%symdel sizeIsValid /NOWARN;\r\n\r\n/*\r\n    Remove all macros from memory.\r\n*/\r\n%SYSMACDELETE request_status / NOWARN;\r\n%SYSMACDELETE create_export / NOWARN;"},"eTag":"W/\"1763475478321959000\""}